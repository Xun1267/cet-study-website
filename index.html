<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„è®¡åˆ’ - å››å…­çº§å¤‡è€ƒä»ªè¡¨ç›˜</title>
    <style>
        /* --- å…¨å±€æ ·å¼ä¸å­—ä½“ (æ— å˜åŒ–) --- */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');
        :root {
            --sidebar-width: 260px; --main-bg: #1a1a2e; --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2); --text-color: #EAECEE; --text-color-darker: #B2BABB;
            --accent-color: #4CAF50; --accent-color-hover: #66BB6A; --accent-text: #2E7D32; 
            --success-color: #28a745; --review-color: #FFC107; --learn-color: #2196F3; --border-radius: 15px;
            
            /* å“åº”å¼å­—ä½“åŸºçº¿ (min 20px) */
            --font-size-base: clamp(20px, 1.5vw, 24px); /* Base for body text */
            --font-size-small: clamp(20px, 1.2vw, 22px); /* Small text, now >= 20px */
            --font-size-large: clamp(22px, 1.8vw, 28px); /* Large text */
            --font-size-title: clamp(24px, 2.2vw, 32px); /* Card titles etc. */
            --font-size-heading: clamp(28px, 2.8vw, 38px); /* Main headings */
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans SC', sans-serif; background-image: linear-gradient(to right top, #5a8c43, #68974d, #77a158, #85ac62, #93b76d);
            background-size: 400% 400%; color: var(--text-color); display: flex; overflow-x: hidden;
            font-size: var(--font-size-base); line-height: 1.6;
        }
        
        /* æ¡Œé¢ç«¯ä¿ç•™æ¸©å’Œçš„èƒŒæ™¯åŠ¨ç”» */
        @media (min-width: 769px) {
            body {
                animation: gradientBG 25s ease infinite;
            }
        }
        
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .glass-effect {
            background: var(--glass-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border); border-radius: var(--border-radius); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
        }

        /* --- æ±‰å ¡èœå•æŒ‰é’® --- */
        .hamburger-menu {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .hamburger-menu:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(1.05);
        }
        .hamburger-icon {
            width: 24px;
            height: 18px;
            position: relative;
        }
        .hamburger-icon span {
            display: block;
            height: 2px;
            width: 100%;
            background: var(--text-color);
            border-radius: 1px;
            position: absolute;
            transition: all 0.3s ease;
        }
        .hamburger-icon span:nth-child(1) { top: 0; }
        .hamburger-icon span:nth-child(2) { top: 8px; }
        .hamburger-icon span:nth-child(3) { top: 16px; }
        
        /* æ±‰å ¡èœå•æ¿€æ´»çŠ¶æ€ */
        .hamburger-menu.active .hamburger-icon span:nth-child(1) {
            transform: rotate(45deg);
            top: 8px;
        }
        .hamburger-menu.active .hamburger-icon span:nth-child(2) {
            opacity: 0;
        }
        .hamburger-menu.active .hamburger-icon span:nth-child(3) {
            transform: rotate(-45deg);
            top: 8px;
        }
        
        /* --- é®ç½©å±‚ --- */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }

        /* --- ä¾§è¾¹æ  (å¾®è°ƒæ¿€æ´»çŠ¶æ€) --- */
        .sidebar { 
            width: var(--sidebar-width); 
            height: 100vh; 
            position: fixed; 
            left: 0; 
            top: 0; 
            padding: 28px 18px; 
            display: flex; 
            flex-direction: column; 
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
            z-index: 1000;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            overflow-x: hidden;
        }
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        .sidebar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        .sidebar .logo { text-align: center; margin-bottom: 45px; }
        .sidebar .logo h1 { font-size: var(--font-size-heading); font-weight: 700; letter-spacing: 1px; }
        .sidebar .logo p { font-size: var(--font-size-base); color: var(--text-color-darker); }
        .sidebar nav ul { list-style: none; flex-grow: 1; }
        .sidebar nav li { margin-bottom: 18px; }
        .sidebar nav a { display: flex; align-items: center; padding: 16px 18px; text-decoration: none; color: var(--text-color); border-radius: 10px; font-weight: 500; transition: background 0.3s ease, color 0.3s ease; cursor: pointer; font-size: var(--font-size-base);}
        .sidebar nav a svg { width: 24px; height: 24px; margin-right: 18px; }
        .sidebar nav a:hover { background: var(--glass-bg); }
        .sidebar nav a.active { background: var(--accent-color); color: #fff; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4); }

        /* --- ä¸»å†…å®¹åŒºåŸŸ (æ— å˜åŒ–) --- */
        .main-content { margin-left: var(--sidebar-width); flex-grow: 1; padding: 30px; min-height: 100vh; }
        .dashboard-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 25px; 
            max-width: 1200px; 
            margin: 0 auto; 
        }
        .grid-item { padding: 25px; animation: fadeInFromBottom 0.5s ease-out forwards; opacity: 0; transform: translateY(20px); }
        @keyframes fadeInFromBottom { to { opacity: 1; transform: translateY(0); } }
        .grid-item:nth-child(1) { animation-delay: 0.1s; }
        .grid-item:nth-child(2) { animation-delay: 0.2s; }
        .grid-item:nth-child(3) { animation-delay: 0.3s; }
        .card-title { font-size: var(--font-size-title); font-weight: 500; margin-bottom: 20px; display: flex; align-items: center; }
        .card-title svg { width: 22px; height: 22px; margin-right: 10px; color: var(--accent-color-hover); }

        /* --- ã€æ–°ã€‘é¡µé¢åˆ‡æ¢æ ·å¼ --- */
        .view { display: none; }
        .view.active { display: block; }
        .view.active-grid { display: grid; } /* ä¿æŒä»ªè¡¨ç›˜çš„ grid å¸ƒå±€ */

        /* --- ã€æ›´æ–°ã€‘ä»Šæ—¥ä»»åŠ¡å¡ç‰‡æ ·å¼ --- */
        .task-list ul { list-style: none; max-height: 200px; overflow-y: auto; padding-right: 10px;}
        .task-list li { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; padding: 10px; border-radius: 8px; transition: background 0.3s ease; }
        .task-list li:hover { background: rgba(255, 255, 255, 0.05); }
        .task-list input[type="checkbox"] { display: none; }
        .task-list label { cursor: pointer; display: flex; align-items: center; flex-grow: 1; }
        .task-list .custom-checkbox { width: 20px; height: 20px; border: 2px solid var(--glass-border); border-radius: 5px; margin-right: 15px; display: flex; align-items: center; justify-content: center; transition: all 0.3s; flex-shrink: 0; }
        .task-list .custom-checkbox svg { width: 14px; height: 14px; color: white; opacity: 0; transform: scale(0.5); transition: all 0.3s; }
        .task-list input[type="checkbox"]:checked + label .custom-checkbox { background-color: var(--success-color); border-color: var(--success-color); }
        .task-list input[type="checkbox"]:checked + label .custom-checkbox svg { opacity: 1; transform: scale(1); }
        .task-list .task-text { transition: all 0.3s; }
        .task-list input[type="checkbox"]:checked + label .task-text { text-decoration: line-through; color: var(--text-color-darker); }
        .delete-task { background: none; border: none; color: var(--text-color-darker); cursor: pointer; opacity: 0; transition: opacity 0.3s; }
        .task-list li:hover .delete-task { opacity: 1; }
        #add-task-form { display: flex; margin-top: 20px; }
        #new-task-input { flex-grow: 1; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 8px; padding: 10px 15px; color: var(--text-color); outline: none; }
        #add-task-btn { background: var(--accent-color); border: none; color: white; padding: 10px 20px; border-radius: 8px; margin-left: 10px; cursor: pointer; transition: background 0.3s; }
        #add-task-btn:hover { background: var(--accent-color-hover); }


        /* --- ã€æ–°ã€‘è¯æ±‡ä¸­å¿ƒæ ·å¼ --- */
        .pdf-card { padding: 25px; text-align: center; }
        .pdf-card svg.file-icon { width: 60px; height: 60px; color: var(--accent-text); margin-bottom: 15px; }
        .pdf-card h4 { font-size: var(--font-size-large); margin-bottom: 10px; }
        .pdf-card p { font-size: var(--font-size-base); color: var(--text-color-darker); margin-bottom: 25px; min-height: 40px; }
        .pdf-actions { display: flex; justify-content: center; gap: 15px; }
        .pdf-actions .btn { padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.3s; font-size: var(--font-size-base); }
        .pdf-actions .btn-preview { background: var(--accent-color); color: white; border: 1px solid var(--accent-color); }
        .pdf-actions .btn-preview:hover { background: var(--accent-color-hover); }
        .pdf-actions .btn-download { background: transparent; color: var(--text-color); border: 1px solid var(--glass-border); }
        .pdf-actions .btn-download:hover { background: var(--glass-bg); }



        /* --- ã€æ–°ã€‘è¯æ±‡æ‰“å¡è¡¨æ ·å¼ --- */
        .checkin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .week-selector { display: flex; gap: 10px; align-items: center; }
        .week-nav-btn { background: var(--glass-bg); border: 1px solid var(--glass-border); color: var(--text-color); padding: 8px 15px; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .week-nav-btn:hover { background: var(--accent-color); }
        .week-info { font-size: 16px; font-weight: 500; margin: 0 15px; }
        
        .checkin-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .checkin-table th, .checkin-table td { padding: 16px; text-align: center; border: 1px solid var(--glass-border); }
        .checkin-table td { font-size: clamp(20px, 1.8vw, 22px); }
        .checkin-table th { background: var(--glass-bg); font-weight: 500; font-size: clamp(20px, 1.8vw, 22px); }
        .checkin-table .day-header { background: rgba(76, 175, 80, 0.12); font-weight: 600; }
        
        .time-slot { margin-bottom: 10px; }
        .time-slot:last-child { margin-bottom: 0; }
        .time-label { font-size: 14px; color: var(--text-color-darker); margin-bottom: 8px; font-weight: 500; }
        
        .checkin-actions { display: flex; gap: 12px; justify-content: center; }
        .checkin-btn {
            padding: 12px 24px;
            font-size: clamp(20px, 1.8vw, 22px);
            border-radius: 12px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 80px;
            position: relative;
            overflow: hidden;
        }
        .checkin-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s ease, height 0.3s ease;
        }
        .checkin-btn:active::before {
            width: 120px;
            height: 120px;
        }
        .checkin-btn.review { background: rgba(255, 193, 7, 0.15); color: var(--review-color); border: 1px solid rgba(255, 193, 7, 0.25); }
        .checkin-btn.review.completed { background: var(--review-color); color: #111; border: 1px solid var(--review-color); }
        .checkin-btn.learn { background: rgba(33, 150, 243, 0.15); color: var(--learn-color); border: 1px solid rgba(33, 150, 243, 0.25); }
        .checkin-btn.learn.completed { background: var(--learn-color); color: white; border: 1px solid var(--learn-color); }
        .checkin-btn:hover:not(.completed) { 
            transform: translateY(-2px) scale(1.05); 
            box-shadow: 0 6px 16px rgba(0,0,0,0.15); 
        }
        .checkin-btn:active {
            transform: translateY(0) scale(0.98);
            transition: all 0.1s ease;
        }
        
        .week-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-top: 20px; }
        .stat-card { padding: 15px; text-align: center; border-radius: 10px; background: var(--glass-bg); }
        .stat-number { font-size: 24px; font-weight: 700; color: var(--accent-text); }
        .stat-label { font-size: 12px; color: var(--text-color-darker); margin-top: 5px; }
        
        /* --- å¤§å±å¹•ä¼˜åŒ– --- */
        @media (min-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (min-width: 1600px) {
            .dashboard-grid {
                grid-template-columns: repeat(3, 380px);
                justify-content: center;
            }
        }

        /* --- å“åº”å¼è®¾è®¡ (æ— å˜åŒ–) --- */
        @media (max-width: 992px) {
            .hamburger-menu { display: block; }
            .sidebar { 
                transform: translateX(-100%); 
                z-index: 1000;
                width: min(280px, 85vw);
                box-shadow: 4px 0 20px rgba(0, 0, 0, 0.15);
            }
            .sidebar.open { 
                transform: translateX(0);
                box-shadow: 4px 0 20px rgba(0, 0, 0, 0.25);
            }
            .main-content { 
                margin-left: 0; 
                padding-top: 80px;
                transition: filter 0.3s ease;
            }
            .main-content.sidebar-open {
                filter: blur(2px);
            }
        }

        /* æ–°å¢ï¼šä¸»é¡µé—®å€™ä¸ä»‹ç»æ ·å¼ */
        .greeting-top { margin-bottom: 18px; }
        .greeting-top h2 { font-size: var(--font-size-heading); font-weight: 600; letter-spacing: 0.5px; }
        .greeting-top h2 span { color: var(--accent-text); }

        .intro-section { display: flex; justify-content: flex-start; margin: 10px 0 26px; width: 100%; }
        .dashboard-grid .intro-section { grid-column: 1 / -1; }
        .intro-card { max-width: 980px; width: 100%; padding: 22px 26px; line-height: 1.9; margin-left: 0; }
        .intro-card h4 { margin: 12px 0 6px; font-size: var(--font-size-large); color: var(--accent-text); }
        .intro-card p { color: var(--text-color); font-size: var(--font-size-base); margin: 8px 0; }

        /* --- æ°´å°æ ·å¼ --- */
        .watermark {
            position: fixed;
            bottom: 15px;
            left: 15px;
            z-index: 1001;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.3);
            text-align: left;
            pointer-events: none; /* ç¡®ä¿æ°´å°ä¸å½±å“ä¸‹å±‚å…ƒç´ çš„äº¤äº’ */
        }
        .watermark p {
            margin: 0;
            line-height: 1.4;
        }

        /* æ¯›ç»ç’ƒåŸºç¡€æ•ˆæœ */
        .glass-effect {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.16);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 14px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
        }

        /* --- ã€æ–°å¢ã€‘èµ„æºåº“æ ·å¼ --- */
        .resource-section {
            margin-bottom: 25px;
            padding: 20px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .resource-section:last-child {
            margin-bottom: 0;
        }
        .resource-item {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-height: 80px;
        }
        .resource-info h5 {
            margin: 0 0 8px 0;
            font-size: var(--font-size-large);
            color: var(--text-color);
            font-weight: 600;
        }
        .resource-info p {
            margin: 0;
            color: var(--text-color-darker);
            font-size: var(--font-size-base);
            line-height: 1.5;
        }
        .resource-actions {
            flex-shrink: 0;
            align-self: flex-start;
        }
        .resource-actions .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: var(--font-size-base);
        }
        .resource-actions .btn-download {
            background: var(--glass-bg);
            color: var(--text-color);
            border: 1px solid var(--glass-border);
        }
        .resource-actions .btn-download:hover {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        /* å“åº”å¼é€‚é… */
        @media (max-width: 768px) {
            .resource-actions {
                width: 100%;
            }
            .resource-actions .btn {
                width: 100%;
                justify-content: center;
            }
        }
    
/* ============== ã€æ–°å¢ã€‘å­¦ä¹ åé¦ˆæ¨¡å—æ ·å¼ ============== */
.feedback-prompt { color: var(--text-color-darker); font-size: 14px; line-height: 1.6; margin-bottom: 8px; display: none; }
.feedback-prompt.active { display: block; }
.feedback-action-btn { 
    margin-top: 10px; 
    padding: 12px 20px; 
    background: var(--glass-bg); 
    backdrop-filter: blur(10px); 
    -webkit-backdrop-filter: blur(10px); 
    border: 1px solid var(--glass-border); 
    border-radius: 14px; 
    color: var(--text-color); 
    cursor: pointer; 
    transition: all 0.3s ease; 
    font-weight: 600; 
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
}
.feedback-action-btn:hover { 
    background: rgba(255,255,255,0.15); 
    transform: translateY(-2px); 
    box-shadow: 0 12px 32px rgba(0,0,0,0.12); 
    border-color: rgba(255,255,255,0.3);
}

/* æ¨¡æ€æ¡†å®¹å™¨ */
.feedback-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display: none; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(4px); animation: fadeIn 0.25s ease; }
.feedback-modal.open { display: flex; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* æ¨¡æ€æ¡†å†…å®¹ */
.feedback-content { width: min(820px, 92vw); max-height: 86vh; overflow: hidden; background: rgba(255,255,255,0.06); border: 1px solid var(--glass-border); border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.35); backdrop-filter: blur(12px); transform: translateY(20px); animation: slideUp 0.35s ease forwards; }
@keyframes slideUp { to { transform: translateY(0); } }

.feedback-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; border-bottom: 1px solid var(--glass-border); background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0)); }
.feedback-header h2 { font-size: 20px; margin: 0; }
.feedback-header .close-feedback { background: transparent; border: none; color: var(--text-color); font-size: 24px; cursor: pointer; padding: 4px 8px; border-radius: 8px; transition: background 0.2s ease; }
.feedback-header .close-feedback:hover { background: rgba(255,255,255,0.08); }

#feedback-form { padding: 14px 20px 20px; overflow: auto; max-height: calc(86vh - 60px); }
.feedback-section { margin-bottom: 16px; padding: 12px; border-radius: 14px; border: 1px dashed var(--glass-border); background: rgba(255,255,255,0.04); }
.feedback-section h3 { margin: 0 0 10px; font-size: 16px; }

/* ä»»åŠ¡å®Œæˆæƒ…å†µåŒºåŸŸ */
.task-completion-list { display: grid; grid-template-columns: 1fr; gap: 8px; }
.task-completion-item { display: flex; align-items: center; justify-content: space-between; padding: 10px 12px; border-radius: 10px; background: rgba(0,0,0,0.18); border: 1px solid var(--glass-border); }
.task-completion-item .left { display: flex; align-items: center; gap: 10px; }
.task-completion-item input[type="checkbox"] { width: 18px; height: 18px; accent-color: var(--success-color); }

/* æ»‘å—æ ·å¼ */
.slider-group { margin-bottom: 12px; }
.slider-label { display: block; margin-bottom: 6px; color: var(--text-color); font-weight: 600; }
.slider-container { display: grid; grid-template-columns: 20px 1fr 20px 40px; align-items: center; gap: 10px; }
.slider { -webkit-appearance: none; appearance: none; width: 100%; height: 6px; border-radius: 10px; background: linear-gradient(90deg, rgba(59,130,246,0.6), rgba(59,130,246,0.2)); outline: none; }
.slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; background: #fff; border: 2px solid var(--accent-color); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.25); transition: transform 0.15s ease; }
.slider::-webkit-slider-thumb:hover { transform: scale(1.06); }
.slider-value { justify-self: end; font-weight: 700; color: var(--accent-color); }

/* æ–‡æœ¬åŸŸã€å•é€‰æ ·å¼ */
.textarea-group textarea { width: 100%; min-height: 70px; border-radius: 12px; background: rgba(0,0,0,0.18); border: 1px solid var(--glass-border); padding: 10px 12px; color: var(--text-color); resize: vertical; }
.radio-group .radio-options { display: grid; grid-template-columns: 1fr; gap: 8px; }
.radio-option { display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-radius: 10px; background: rgba(0,0,0,0.18); border: 1px solid var(--glass-border); }
.radio-option input[type="radio"] { accent-color: var(--accent-color); }

/* æäº¤æŒ‰é’® */
.feedback-submit { width: 100%; padding: 12px 16px; border: none; border-radius: 12px; background: linear-gradient(135deg, var(--accent-color), #7aa7ff); color: #fff; font-weight: 700; cursor: pointer; box-shadow: 0 10px 30px rgba(59,130,246,0.35); transition: transform 0.2s ease, box-shadow 0.2s ease; }
.feedback-submit:hover { transform: translateY(-1px); box-shadow: 0 16px 36px rgba(59,130,246,0.45); }

@media (min-width: 720px) {
  .task-completion-list { grid-template-columns: 1fr 1fr; }
}

</style>
</head>
<body>

    <!-- ======================= æ±‰å ¡èœå•æŒ‰é’® ======================= -->
    <div class="hamburger-menu" id="hamburger-menu">
        <div class="hamburger-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <!-- ======================= é®ç½©å±‚ ======================= -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <!-- ======================= ä¾§è¾¹æ å¯¼èˆª ======================= -->
    <aside class="sidebar glass-effect">
        <div class="logo">
            <h1 class="platform-name">å››å…­çº§<br>å¤‡è€ƒå¹³å°</h1>
        </div>
        <nav>
            <ul>
                <li><a class="nav-link active" data-view="dashboard-view">
                    <svg xmlns="http://www.w.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>æˆ‘çš„è®¡åˆ’</a></li>
                <li><a class="nav-link" data-view="vocab-view">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5v0Z"/><path d="M4 5h16"/><path d="M4 12h16"/><path d="M4 8h16"/><path d="M4 16h16"/></svg>è¯æ±‡ä¸­å¿ƒ</a></li>
                <li><a class="nav-link" data-view="checkin-view">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>è¯æ±‡æ‰“å¡è¡¨</a></li>
                <li><a class="nav-link" data-view="training-view"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>ä¸“é¡¹è®­ç»ƒ</a></li>
                <li><a class="nav-link" data-view="history-view"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v5h5"/><path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"/><path d="M12 7v5l4 2"/></svg>å†å²å›é¡¾</a></li>
                <li><a class="nav-link" data-view="zhenti-view"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg>çœŸé¢˜åœ¨çº¿</a></li>
                <li><a class="nav-link" data-view="resource-view"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>èµ„æºåº“</a></li>

            </ul>
        </nav>
        
        <!-- ç”¨æˆ·æ˜µç§°åŒºåŸŸ -->
        <div class="user-nickname glass-effect" style="margin-top: 20px; padding: 15px; text-align: center; border-radius: 12px; background: var(--glass-bg); border: 1px solid var(--glass-border);">
            <div id="nickname-display" style="font-size: var(--font-size-large); font-weight: 600; color: var(--text-color); cursor: pointer; transition: all 0.3s ease;" onclick="editNickname()">
                å¤‡è€ƒå°èƒ½æ‰‹
            </div>
            <p style="font-size: var(--font-size-small); color: var(--text-color-darker); margin: 5px 0 0 0;">ç‚¹å‡»ç¼–è¾‘æ˜µç§°</p>
        </div>

    </aside>

    <!-- ======================= ä¸»å†…å®¹åŒºåŸŸ ======================= -->
    <main class="main-content">
        <!-- é¡¶éƒ¨é—®å€™ -->
        <div class="greeting-top">
            <h2>ä½ å¥½ï¼Œ<span id="greet-name">å¤‡è€ƒå°èƒ½æ‰‹</span></h2>
        </div>

        <!-- ã€è§†å›¾1ã€‘ä»ªè¡¨ç›˜ -->
        <div id="dashboard-view" class="view active-grid dashboard-grid">
            <!-- --- ã€æ›´æ–°ã€‘ä»Šæ—¥ä»»åŠ¡ --- -->
            <div class="grid-item glass-effect">
                <h3 class="card-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>ä»Šæ—¥ä»»åŠ¡</h3>
                <div class="task-list">
                    <ul id="task-list-ul">
                        <!-- ä»»åŠ¡å°†ç”±JSåŠ¨æ€æ·»åŠ  -->
                    </ul>
                </div>
                <form id="add-task-form">
                    <input type="text" id="new-task-input" placeholder="æ·»åŠ æ–°ä»»åŠ¡..." autocomplete="off">
                    <button type="submit" id="add-task-btn">æ·»åŠ </button>
                </form>
            </div>

            <!-- ã€æ–°å¢ã€‘æ¯æ—¥å­¦ä¹ åé¦ˆå¡ç‰‡ -->
            <div class="grid-item glass-effect">
                <h3 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2h-4M9 11V9a3 3 0 1 1 6 0v2M9 11h6"/><path d="M12 15v2"/></svg>
                    æ¯æ—¥å­¦ä¹ åé¦ˆ
                </h3>
                <div id="feedback-status-area">
                    <!-- å®Œæˆå‰æç¤º -->
                    <div id="feedback-before" class="feedback-prompt active">
                        <p>ğŸ“ ä»Šå¤©çš„å­¦ä¹ å¦‚ä½•ï¼Ÿ</p>
                        <p style="color: var(--text-color-darker); font-size: var(--font-size-small); margin-bottom: 15px;">é€šè¿‡åæ€æ€»ç»“ï¼Œè®©æ¯å¤©çš„è¿›æ­¥éƒ½è¢«çœ‹è§</p>
                    </div>
                    
                    <!-- å®Œæˆåæç¤º -->
                    <div id="feedback-after" class="feedback-prompt">
                        <p>âœ… ä»Šæ—¥åé¦ˆå·²å®Œæˆ</p>
                        <p style="color: var(--text-color-darker); font-size: var(--font-size-small); margin-bottom: 15px;">æ„Ÿè°¢ä½ çš„åšæŒï¼æ˜å¤©è§</p>
                    </div>
                </div>
                
                <button id="feedback-btn" class="feedback-action-btn">
                    <span id="feedback-btn-text">å¼€å§‹åé¦ˆ</span>
                </button>
                
                <!-- ç®€è¦ç»Ÿè®¡æ˜¾ç¤º -->
                <div id="feedback-stats" style="margin-top: 15px; display: none;">
                    <div style="display: flex; justify-content: space-between; color: var(--text-color-darker); font-size: var(--font-size-small);">
                        <span>ä¸“æ³¨åº¦: <span id="stat-focus">-</span>/5</span>
                        <span>ç§¯ææ€§: <span id="stat-motivation">-</span>/5</span>
                        <span>ä»»åŠ¡å®Œæˆ: <span id="stat-task-completion">-</span>%</span>
                    </div>
                </div>
            </div>

            <!-- ã€æ–°å¢ã€‘å­¦ä¹ åé¦ˆè¶‹åŠ¿å›¾ -->
            <div class="grid-item glass-effect">
                <h3 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                    å­¦ä¹ çŠ¶æ€è¶‹åŠ¿
                </h3>
                <p style="color: var(--text-color-darker); font-size: var(--font-size-small); margin-bottom: 15px;">7å¤©ä¸“æ³¨åº¦å’Œç§¯ææ€§å˜åŒ–æ›²çº¿</p>
                
                <!-- å›¾è¡¨å®¹å™¨ -->
                <div style="position: relative; height: 180px; margin-top: 15px;">
                    <canvas id="feedback-chart" style="width: 100%; height: 100%;"></canvas>
                </div>
                
                <!-- å›¾è¡¨ä¸‹æ–¹ç®€è¦ç»Ÿè®¡ -->
                <div style="margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: var(--font-size-small); color: var(--text-color-darker);">
                    <div style="text-align: center;">
                        <div style="font-weight: 600; color: var(--accent-color);" id="avg-focus">-</div>
                        <div>å¹³å‡ä¸“æ³¨åº¦</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-weight: 600; color: #10b981;" id="avg-motivation">-</div>
                        <div>å¹³å‡ç§¯ææ€§</div>
                    </div>
                </div>
            </div>

            <!-- ä¸­éƒ¨æ¯›ç»ç’ƒä»‹ç»ï¼ˆä½äºä»Šæ—¥ä»»åŠ¡ä¸‹æ–¹ï¼‰ -->
            <section class="intro-section">
                <div class="intro-card glass-effect">
                    <h4>æ¬¢è¿æ¥åˆ°è¿™é‡Œï¼</h4>
                    <p>æˆ‘ä»¬æ·±çŸ¥ï¼Œå¤‡è€ƒå››å…­çº§æœ€ä»¤äººæ²®ä¸§çš„ï¼Œä¸æ˜¯å•è¯æœ‰å¤šéš¾èƒŒï¼Œè€Œæ˜¯ä»˜å‡ºçš„åŠªåŠ›ä»¿ä½›çŸ³æ²‰å¤§æµ·ï¼Œä¸çŸ¥é“è‡ªå·±ç©¶ç«Ÿåœ¨å“ªï¼Œç¦»ç›®æ ‡è¿˜æœ‰å¤šè¿œã€‚</p>
                    <p>åœ¨å¼€å§‹å¤‡è€ƒå‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šè‹±è¯­è€ƒè¯•çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå¹¶éå­¤ç«‹çš„çŸ¥è¯†ç‚¹è€ƒå¯Ÿï¼Œè€Œæ˜¯ä¸€é—¨è¯­è¨€èƒ½åŠ›çš„ç»¼åˆä½“ç°ã€‚è¯­è¨€å­¦ä¹ æ˜¯ä¸€ä¸ªé•¿æœŸç§¯ç´¯ã€å½¢æˆæƒ¯æ€§çš„è¿‡ç¨‹ã€‚åªæœ‰å½“ä½ å°†è‹±è¯­å­¦ä¹ å†…åŒ–ä¸ºä¸€ç§ç¨³å®šã€æŒç»­çš„ä¹ æƒ¯æ—¶ï¼Œæ‰èƒ½åœ¨è€ƒåœºå‹åŠ›ä¸‹å‘æŒ¥å‡ºåº”æœ‰çš„æ°´å¹³ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„å¤‡è€ƒæ€è·¯ï¼Œå§‹äºå¯¹è¯­è¨€æœ¬èº«çš„respectï¼Œè‡´åŠ›äºä¸ºä½ æ„å»ºä¸€ä¸ªå¥åº·ã€å¯æŒç»­çš„å­¦ä¹ ç”Ÿæ€ã€‚</p>
                    
                    <h4>1. åŸºçŸ³ï¼šå°†è¯æ±‡å­¦ä¹ ï¼Œå†…åŒ–ä¸ºä¸€ç§é«˜æ•ˆçš„æƒ¯æ€§</h4>
                    <p>è¯æ±‡æ˜¯è‹±è¯­ä¸–ç•Œæœ€åŸºæœ¬çš„é€šè¡Œè¯ã€‚ä½†ä¼ ç»Ÿçš„æ­»è®°ç¡¬èƒŒåªä¼šå¸¦æ¥æŒ«è´¥æ„Ÿã€‚æˆ‘ä»¬å¿…é¡» recognizesï¼ŒèƒŒå•è¯çš„æœ¬è´¨æ˜¯å¯¹æŠ—é—å¿˜ï¼Œè€Œè¿™ä¸ªéœ€è¦å½¢æˆä¸€ä¸ªç§‘å­¦çš„ä¹ æƒ¯ã€‚æˆ‘ä»¬æ¨å´‡çš„ï¼Œæ˜¯åŸºäºâ€œè‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿â€çš„å¤ä¹ æœºåˆ¶ï¼šè®©â€œå¤ä¹ â€ä¸â€œå­¦ä¹ â€è¿™ä¸¤ä¸ªç¯èŠ‚æ°¸è¿œå¹¶è¡Œã€‚ä½ æ¯å¤©çš„ä»»åŠ¡ä¸ä»…æ˜¯è®¤è¯†æ–°è¯ï¼Œæ›´é‡è¦çš„æ˜¯åœ¨é—å¿˜å‘ç”Ÿå‰ï¼ŒåŠæ—¶ã€é«˜é¢‘åœ°é‡æ¸©æ—§è¯†ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè¯æ±‡å­¦ä¹ ä¸å†æ˜¯ä¸€åœºç—›è‹¦æ”»åšæˆ˜ï¼Œè€Œæ˜¯èå…¥ä½ æ—¥å¸¸çš„ã€å¯ç§¯ç´¯çš„ç¨³å®šæƒ¯æ€§ã€‚</p>
                    
                    <h4>2. æ ¸å¿ƒï¼šåœ¨å®æˆ˜åº”ç”¨ä¸­ï¼Œç†è§£è¯­è¨€çš„å†…åœ¨é€»è¾‘</h4>
                    <p>æŒæ¡äº†è¯æ±‡ï¼Œæˆ‘ä»¬ä¾¿éœ€è¦é€šè¿‡å¬è¯´è¯»å†™è¯‘çš„ç»ƒä¹ ï¼Œå»ç†è§£è‹±è¯­ä½œä¸ºä¸€é—¨è¯­è¨€çš„çœŸå®æ ·è²Œå’Œå†…åœ¨é€»è¾‘ã€‚æ¯ä¸€ä¸ªä¸“é¡¹è®­ç»ƒï¼Œéƒ½ä¸æ˜¯ä¸ºäº†å­¤ç«‹åœ°â€œåˆ·é¢˜â€ï¼Œè€Œæ˜¯ä¸ºäº†åŠ æ·±ä½ å¯¹è¯­è¨€çš„æ„ŸçŸ¥åŠ›ã€‚ä¾‹å¦‚ï¼Œç²¾å¬è®­ç»ƒæ˜¯ä¸ºäº†è®©ä½ æ•æ‰ä¿¡æ¯çš„æµåŠ¨ï¼Œé™æ—¶é˜…è¯»æ˜¯ä¸ºäº†è®©ä½ é€‚åº”è‹±æ–‡çš„å™äº‹èŠ‚å¥ï¼Œè€Œå†™ä½œä¸ç¿»è¯‘åˆ™æ˜¯è®­ç»ƒä½ ç”¨è‹±è¯­çš„é€»è¾‘å»ç»„ç»‡å’Œè¡¨è¾¾æ€æƒ³ã€‚æˆ‘ä»¬å¼ºè°ƒæ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼Œæ—¨åœ¨å¸®åŠ©ä½ ä»â€œè®¤è¯†å•è¯â€è·¨è¶Šåˆ°â€œç†è§£è¯­ç¯‡â€ï¼ŒçœŸæ­£åšåˆ°å­¦ä»¥è‡´ç”¨ã€‚</p>
                    
                    <h4>3. çµé­‚ï¼šé€šè¿‡ç²¾å‡†åé¦ˆï¼Œæ¸…æ™°ä½ çš„èƒ½åŠ›è¾¹ç•Œ</h4>
                    <p>è®¸å¤šå­¦ç”Ÿç›´åˆ°èµ°è¿›è€ƒåœºï¼Œéƒ½å¯¹è‡ªå·±â€œèƒ½è€ƒå¤šå°‘åˆ†â€ç¼ºä¹æ¸…æ™°çš„è®¤çŸ¥ã€‚è¿™æ˜¯å› ä¸ºä»–ä»¬å¯¹è‡ªå·±å­¦ä¹ ç¨‹åº¦çš„æŒæ¡æ˜¯æ¨¡ç³Šçš„ã€å‡­æ„Ÿè§‰çš„ã€‚å­¦ä¹ ä¸€é—¨è¯­è¨€çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ä¸ªäººç†è§£èƒ½åŠ›è¾¹ç•Œè¢«ä¸æ–­è¯•æ¢ã€ä¸æ–­æ¸…æ™°åŒ–çš„è¿‡ç¨‹ã€‚ è€Œç³»ç»Ÿæ€§çš„åé¦ˆï¼Œå°±æ˜¯å¸®åŠ©ä½ ä¸»åŠ¨æç»˜è¿™ä¸ªè¾¹ç•Œçš„å·¥å…·ã€‚æˆ‘ä»¬çš„åé¦ˆæœºåˆ¶ï¼ˆæ¯æ—¥åæ€ã€æ¯å‘¨å¤ç›˜ã€è€ƒåè¯Šæ–­ï¼‰å¹¶éç®€å•çš„å¯¹é”™è®°å½•ï¼Œè€Œæ˜¯å¼•å¯¼ä½ è¿›è¡Œæ·±åº¦æ€è€ƒçš„æ¢é’ˆï¼šæˆ‘ä¸ºä»€ä¹ˆä¼šåœ¨è¿™é‡Œå¡ä½ï¼Ÿæˆ‘çš„å›°éš¾æ˜¯æºäºçŸ¥è¯†ç›²åŒºè¿˜æ˜¯æŠ€èƒ½ç¼ºé™·ï¼Ÿé€šè¿‡æŒç»­çš„è‡ªæˆ‘å®¡è§†ï¼Œä½ èƒ½åŠæ—¶è°ƒæ•´å­¦ä¹ çš„èˆªå‘ï¼Œå˜è¢«åŠ¨çš„â€œå®Œæˆä»»åŠ¡â€ä¸ºä¸»åŠ¨çš„â€œè§£å†³é—®é¢˜â€ï¼Œæœ€ç»ˆå¸¦ç€è‡ªå·±å¯¹èƒ½åŠ›çš„æ¸…æ™°è®¤çŸ¥ï¼Œè‡ªä¿¡åœ°èµ°å‘è€ƒåœºã€‚</p>
                    
                    <h4>æ€»ç»“</h4>
                    <p>æ€»ç»“è€Œè¨€ï¼Œæˆ‘ä»¬çš„æ–¹æ³•è®ºæ˜¯ä¸€æ¡æ¸…æ™°çš„è·¯å¾„ï¼š ä»å»ºç«‹è¯æ±‡æƒ¯æ€§å‡ºå‘ï¼Œé€šè¿‡å®æˆ˜ç†è§£è¯­è¨€ï¼Œæœ€ç»ˆä¾é åé¦ˆçœ‹æ¸…è‡ªå·±ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œæœ€å¥½çš„å¤‡è€ƒï¼Œæ˜¯è®©ä½ åœ¨æå‡åˆ†æ•°çš„åŒæ—¶ï¼Œä¹ŸçœŸæ­£æå‡è¯­è¨€èƒ½åŠ›ï¼Œå¹¶æŒæ¡ä¸€å¥—ç»ˆèº«å—ç›Šçš„å­¦ä¹ æ–¹æ³•ã€‚</p>
                </div>
            </section>
        </div>

        <!-- ã€è§†å›¾2ã€‘è¯æ±‡ä¸­å¿ƒ -->
        <div id="vocab-view" class="view dashboard-grid">
            <div class="grid-item glass-effect pdf-card">
                <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
                <h4>è€ƒè¯•å¤§çº²</h4>
                <p>å®˜æ–¹å‘å¸ƒçš„å®Œæ•´è¯æ±‡åˆ—è¡¨ï¼Œå¤‡è€ƒå¿…å¤‡çš„åŸºç¡€èµ„æ–™ã€‚</p>
                <div class="pdf-actions">
                    <a href="https://pan.quark.cn/s/125713bd9691" target="_blank" class="btn btn-download">ç½‘ç›˜ä¸‹è½½</a>
                </div>
            </div>
            <div class="grid-item glass-effect pdf-card">
                <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="m10.3 16.3 1.4-1.4 1.4 1.4"/><path d="M12 19v-6"/></svg>
                <h4>å››çº§è¯æ±‡é—ªè¿‡</h4>
                <p>é«˜æ•ˆçš„è¯æ ¹è¯ç¼€è®°å¿†æ³•ä¹¦ç±ï¼Œå¿«é€Ÿæ‰©å¤§ä½ çš„è¯æ±‡é‡ã€‚</p>
                <div class="pdf-actions">
                    <a href="https://pan.quark.cn/s/94d414336c31" target="_blank" class="btn btn-download">ç½‘ç›˜ä¸‹è½½</a>
                </div>
            </div>
            <div class="grid-item glass-effect pdf-card">
                <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
                <h4>å…­çº§è¯æ±‡é—ªè¿‡</h4>
                <p>å…¨å›½å¤§å­¦è‹±è¯­å…­çº§è€ƒè¯•è€ƒçº²è¯æ±‡ï¼Œé«˜æ•ˆè®°å¿†æ³•ä¹¦ç±ã€‚</p>
                <div class="pdf-actions">
                    <a href="https://pan.quark.cn/s/a7a4fc5d9df4" target="_blank" class="btn btn-download">ç½‘ç›˜ä¸‹è½½</a>
                </div>
            </div>
        </div>

        <!-- ã€è§†å›¾3ã€‘è¯æ±‡æ‰“å¡è¡¨ï¼ˆåŒè½®å¤ä¹ ï¼‰ -->
        <div id="checkin-view" class="view">
            <div class="checkin-header">
                <h3 class="card-title" style="margin-bottom:0;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                    è¯æ±‡æ‰“å¡è¡¨ï¼ˆåŒè½®å¤ä¹ ï¼‰
                </h3>
                <div class="week-selector">
                    <button class="week-nav-btn" id="prev-week">ä¸Šå‘¨</button>
                    <div class="week-info" id="week-info">ç¬¬ 1 å‘¨</div>
                    <button class="week-nav-btn" id="next-week">ä¸‹å‘¨</button>
                </div>
            </div>

            <table class="checkin-table glass-effect">
                <thead>
                    <tr>
                        <th>æ—¥æœŸ</th>
                        <th>ä¸Šåˆï¼ˆå¤ä¹ /å­¦ä¹ ï¼‰</th>
                        <th>æ™šä¸Šï¼ˆå¤ä¹ /å­¦ä¹ ï¼‰</th>
                    </tr>
                </thead>
                <tbody id="checkin-tbody">
                    <!-- ç”±è„šæœ¬åŠ¨æ€æ¸²æŸ“ä¸€å‘¨ï¼ˆ7å¤©ï¼‰ -->
                </tbody>
            </table>

            <div class="week-stats">
                <div class="stat-card glass-effect">
                    <div class="stat-number" id="stat-total">0</div>
                    <div class="stat-label">æœ¬å‘¨æ€»æ‰“å¡ï¼ˆæ¬¡ï¼‰</div>
                </div>
                <div class="stat-card glass-effect">
                    <div class="stat-number" id="stat-review">0</div>
                    <div class="stat-label">å¤ä¹ å®Œæˆï¼ˆæ¬¡ï¼‰</div>
                </div>
                <div class="stat-card glass-effect">
                    <div class="stat-number" id="stat-learn">0</div>
                    <div class="stat-label">å­¦ä¹ å®Œæˆï¼ˆæ¬¡ï¼‰</div>
                </div>
                <div class="stat-card glass-effect">
                    <div class="stat-number" id="stat-days">0/7</div>
                    <div class="stat-label">è¾¾æˆæ‰“å¡çš„å¤©æ•°</div>
                </div>
            </div>

            <!-- æŠ˜çº¿å›¾å®¹å™¨ -->
            <div class="glass-effect" style="margin-top: 20px; padding: 15px; border-radius: 12px;">
                <canvas id="checkin-chart" height="120"></canvas>
            </div>
        </div>

        <!-- ã€è§†å›¾4ã€‘ä¸“é¡¹è®­ç»ƒè§†å›¾ -->
        <div id="training-view" class="view dashboard-grid">
            <!-- å¬åŠ›è®­ç»ƒæ¿å— -->
            <div class="grid-item glass-effect">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 class="card-title" style="margin: 0;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        å¬åŠ›è®­ç»ƒ
                    </h3>
                    <button 
                        id="open-listening-external"
                        style="padding: 8px 16px; background: var(--accent-color); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 6px;"
                        title="åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                            <polyline points="15,3 21,3 21,9"/>
                            <line x1="10" y1="14" x2="21" y2="3"/>
                        </svg>
                        æ–°çª—å£æ‰“å¼€
                    </button>
                </div>
                <p style="color: var(--text-color-darker); margin-bottom: 15px;">VOA æ…¢é€Ÿè‹±è¯­ - ä¸“ä¸šçš„å¬åŠ›ç»ƒä¹ å¹³å°</p>
                
                <!-- iframe å®¹å™¨ -->
                <div style="position: relative; width: 100%; height: 500px; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.12);">
                    <div style="position: absolute; top: 10px; right: 10px; z-index: 10;">
                        <button 
                            onclick="window.open('https://www.21voa.com/special_english/', '_blank')"
                            style="padding: 8px 12px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; display: flex; align-items: center; gap: 6px;"
                            title="åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                <polyline points="15,3 21,3 21,9"/>
                                <line x1="10" y1="14" x2="21" y2="3"/>
                            </svg>
                            æ–°çª—å£
                        </button>
                    </div>
                    <iframe 
                        src="https://www.21voa.com/special_english/" 
                        frameborder="0" 
                        style="width: 100%; height: 100%;"
                        title="VOA å¬åŠ›ç»ƒä¹ "
                        onload="this.style.opacity='1'"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
                    </iframe>
                    
                    <!-- å¤‡ç”¨æç¤º -->
                    <div style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: var(--text-color);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px; opacity: 0.6;"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                        <p style="margin: 0; color: var(--text-color-darker);">æ— æ³•åŠ è½½å¬åŠ›ç»ƒä¹ é¡µé¢</p>
                        <a href="https://www.21voa.com/special_english/" target="_blank" style="color: var(--accent-color); text-decoration: none; font-size: var(--font-size-base); margin-top: 10px; display: inline-block;">
                            ç‚¹å‡»æ­¤å¤„åœ¨æ–°çª—å£æ‰“å¼€ â†’
                        </a>
                    </div>
                </div>
            </div>

            <!-- é˜…è¯»è®­ç»ƒæ¿å— -->
            <div class="grid-item glass-effect" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 200px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px; opacity: 0.6;"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
                <h3 class="card-title" style="margin-bottom: 8px;">é˜…è¯»è®­ç»ƒ</h3>
                <p style="color: var(--text-color-darker); text-align: center; margin: 0;">æ–½å·¥ä¸­...</p>
                <p style="color: var(--text-color-darker); font-size: var(--font-size-small); text-align: center; margin-top: 5px;">æ•¬è¯·æœŸå¾…é˜…è¯»ç†è§£ä¸“é¡¹ç»ƒä¹ </p>
            </div>

            <!-- ç¿»è¯‘è®­ç»ƒæ¿å— -->
            <div class="grid-item glass-effect" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 200px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px; opacity: 0.6;"><path d="M5 8l6 6"/><path d="M4 14l6-6 2-3"/><path d="M2 5h12"/><path d="M7 2h1"/><path d="M22 22l-5-10-5 10"/><path d="M14 18h6"/></svg>
                <h3 class="card-title" style="margin-bottom: 8px;">ç¿»è¯‘è®­ç»ƒ</h3>
                <p style="color: var(--text-color-darker); text-align: center; margin: 0;">æ–½å·¥ä¸­...</p>
                <p style="color: var(--text-color-darker); font-size: var(--font-size-small); text-align: center; margin-top: 5px;">æ•¬è¯·æœŸå¾…ç¿»è¯‘ä¸“é¡¹ç»ƒä¹ </p>
            </div>

            <!-- å†™ä½œè®­ç»ƒæ¿å— -->
            <div class="grid-item glass-effect" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 200px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px; opacity: 0.6;"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
                <h3 class="card-title" style="margin-bottom: 8px;">å†™ä½œè®­ç»ƒ</h3>
                <p style="color: var(--text-color-darker); text-align: center; margin: 0;">æ–½å·¥ä¸­...</p>
                <p style="color: var(--text-color-darker); font-size: var(--font-size-small); text-align: center; margin-top: 5px;">æ•¬è¯·æœŸå¾…å†™ä½œä¸“é¡¹ç»ƒä¹ </p>
            </div>
        </div>

        <!-- ã€è§†å›¾5ã€‘å†å²å›é¡¾è§†å›¾ -->
        <div id="history-view" class="view">
            <!-- å†å²å›é¡¾å¤´éƒ¨ -->
            <div class="history-header glass-effect" style="margin-bottom: 20px; padding: 20px; border-radius: 12px;">
                <h2 style="margin: 0 0 10px 0; font-size: 24px; color: var(--text-color);">ğŸ“Š å­¦ä¹ å†å²å›é¡¾</h2>
                <p style="margin: 0; color: var(--text-color-darker); font-size: 16px;">æŸ¥çœ‹æ‚¨çš„å­¦ä¹ è½¨è¿¹ï¼Œåˆ†æè¿›æ­¥è¶‹åŠ¿</p>
            </div>

            <!-- å¿«é€Ÿç»Ÿè®¡å¡ç‰‡ -->
            <div class="history-stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                <div class="stat-card glass-effect" style="padding: 20px; border-radius: 12px; text-align: center;">
                    <div class="stat-number" id="total-days" style="font-size: 28px; font-weight: 700; color: var(--accent-color); margin-bottom: 5px;">0</div>
                    <div class="stat-label" style="color: var(--text-color-darker); font-size: 14px;">æ€»å­¦ä¹ å¤©æ•°</div>
                </div>
                <div class="stat-card glass-effect" style="padding: 20px; border-radius: 12px; text-align: center;">
                    <div class="stat-number" id="avg-completion" style="font-size: 28px; font-weight: 700; color: var(--success-color); margin-bottom: 5px;">0%</div>
                    <div class="stat-label" style="color: var(--text-color-darker); font-size: 14px;">å¹³å‡å®Œæˆç‡</div>
                </div>
                <div class="stat-card glass-effect" style="padding: 20px; border-radius: 12px; text-align: center;">
                    <div class="stat-number" id="streak-days" style="font-size: 28px; font-weight: 700; color: var(--warning-color); margin-bottom: 5px;">0</div>
                    <div class="stat-label" style="color: var(--text-color-darker); font-size: 14px;">è¿ç»­å­¦ä¹ å¤©æ•°</div>
                </div>
                <div class="stat-card glass-effect" style="padding: 20px; border-radius: 12px; text-align: center;">
                    <div class="stat-number" id="avg-focus" style="font-size: 28px; font-weight: 700; color: var(--info-color); margin-bottom: 5px;">0</div>
                    <div class="stat-label" style="color: var(--text-color-darker); font-size: 14px;">å¹³å‡ä¸“æ³¨åº¦</div>
                </div>
            </div>

            <!-- ç­›é€‰å’Œæ§åˆ¶é¢æ¿ -->
            <div class="history-controls glass-effect" style="margin-bottom: 20px; padding: 20px; border-radius: 12px;">
                <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center; justify-content: space-between;">
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-color); font-size: 14px;">æ—¥æœŸèŒƒå›´</label>
                            <select id="date-range-select" style="padding: 8px 12px; border-radius: 8px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); color: var(--text-color);">
                                <option value="7">æœ€è¿‘7å¤©</option>
                                <option value="30" selected>æœ€è¿‘30å¤©</option>
                                <option value="90">æœ€è¿‘90å¤©</option>
                                <option value="all">å…¨éƒ¨</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: var(--text-color); font-size: 14px;">æ•°æ®ç±»å‹</label>
                            <select id="data-type-select" style="padding: 8px 12px; border-radius: 8px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); color: var(--text-color);">
                                <option value="all" selected>å…¨éƒ¨æ•°æ®</option>
                                <option value="tasks">ä»»åŠ¡å®Œæˆ</option>
                                <option value="feedback">å­¦ä¹ åé¦ˆ</option>
                                <option value="checkin">è¯æ±‡æ‰“å¡</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button id="refresh-history" class="btn-secondary" style="padding: 8px 16px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); color: var(--text-color); cursor: pointer;">ğŸ”„ åˆ·æ–°</button>
                        <button id="export-history" class="btn-primary" style="padding: 8px 16px; border-radius: 8px; background: var(--accent-color); border: none; color: white; cursor: pointer;">ğŸ“Š å¯¼å‡º</button>
                            <button id="test-history" class="btn-secondary" style="padding: 8px 16px; border-radius: 8px; background: #6c757d; border: none; color: white; cursor: pointer; margin-left: 8px;">ğŸ§ª æµ‹è¯•</button>
                    </div>
                </div>
            </div>

            <!-- å†å²è¶‹åŠ¿å›¾è¡¨ -->
            <div class="history-chart-container glass-effect" style="margin-bottom: 20px; padding: 20px; border-radius: 12px;">
                <h3 style="margin: 0 0 15px 0; color: var(--text-color); font-size: 18px;">ğŸ“ˆ å­¦ä¹ è¶‹åŠ¿åˆ†æ</h3>
                <div style="position: relative; height: 300px;">
                    <canvas id="history-trend-chart"></canvas>
                </div>
            </div>

            <!-- å†å²æ•°æ®åˆ—è¡¨ -->
            <div class="history-data-container glass-effect" style="padding: 20px; border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: var(--text-color); font-size: 18px;">ğŸ“‹ å†å²è®°å½•è¯¦æƒ…</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span id="data-count" style="color: var(--text-color-darker); font-size: 14px;">å…± 0 æ¡è®°å½•</span>
                        <div style="display: flex; gap: 5px;">
                            <button id="prev-page" class="btn-secondary" style="padding: 5px 10px; border-radius: 6px; background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); color: var(--text-color); cursor: pointer;">â€¹</button>
                            <span id="page-info" style="color: var(--text-color); font-size: 14px; padding: 5px 10px;">1/1</span>
                            <button id="next-page" class="btn-secondary" style="padding: 5px 10px; border-radius: 6px; background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); color: var(--text-color); cursor: pointer;">â€º</button>
                        </div>
                    </div>
                </div>
                
                <!-- æ•°æ®è¡¨æ ¼ -->
                <div class="history-table-wrapper" style="overflow-x: auto;">
                    <table id="history-data-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: rgba(255,255,255,0.05); border-bottom: 1px solid var(--glass-border);">
                                <th style="padding: 12px; text-align: left; color: var(--text-color); font-weight: 600;">æ—¥æœŸ</th>
                                <th style="padding: 12px; text-align: left; color: var(--text-color); font-weight: 600;">ä»»åŠ¡å®Œæˆç‡</th>
                                <th style="padding: 12px; text-align: left; color: var(--text-color); font-weight: 600;">ä¸“æ³¨åº¦</th>
                                <th style="padding: 12px; text-align: left; color: var(--text-color); font-weight: 600;">ç§¯ææ€§</th>
                                <th style="padding: 12px; text-align: left; color: var(--text-color); font-weight: 600;">è¯æ±‡æ‰“å¡</th>
                                <th style="padding: 12px; text-align: left; color: var(--text-color); font-weight: 600;">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body">
                            <!-- åŠ¨æ€ç”Ÿæˆçš„å†å²æ•°æ®è¡Œ -->
                        </tbody>
                    </table>
                </div>
                
                <!-- ç©ºçŠ¶æ€ -->
                <div id="empty-state" class="empty-state" style="display: none; text-align: center; padding: 40px; color: var(--text-color-darker);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px; opacity: 0.6;"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                    <p style="margin: 0; font-size: 16px;">æš‚æ— å†å²æ•°æ®</p>
                    <p style="margin: 5px 0 0 0; font-size: 14px;">å¼€å§‹æ‚¨çš„å­¦ä¹ ä¹‹æ—…ï¼Œè®°å½•æ¯ä¸€å¤©çš„è¿›æ­¥ï¼</p>
                </div>
            </div>
        </div>

        <!-- ======================= çœŸé¢˜åœ¨çº¿é¡µé¢ ======================= -->
        <div id="zhenti-view" class="view">
            <div class="zhenti-header glass-effect" style="margin-bottom: 20px; padding: 20px; border-radius: 12px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 style="margin: 0 0 10px 0; font-size: 24px; color: var(--text-color);">ğŸ“ çœŸé¢˜åœ¨çº¿</h2>
                        <p style="margin: 0; color: var(--text-color-darker); font-size: 16px;">åœ¨çº¿ç»ƒä¹ å†å¹´çœŸé¢˜ï¼Œæå‡åº”è¯•èƒ½åŠ›</p>
                    </div>
                    <button 
                        id="open-zhenti-external" 
                        style="padding: 12px 20px; background: var(--accent-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease;"
                        onmouseover="this.style.background='var(--accent-hover)'"
                        onmouseout="this.style.background='var(--accent-color)'">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                            <polyline points="15,3 21,3 21,9"/>
                            <line x1="10" y1="14" x2="21" y2="3"/>
                        </svg>
                        æ–°çª—å£æ‰“å¼€
                    </button>
                </div>
            </div>
            
            <div class="zhenti-content glass-effect" style="padding: 0; border-radius: 12px; height: calc(100vh - 220px); overflow: hidden; position: relative;">
                <div style="position: absolute; top: 10px; right: 10px; z-index: 10;">
                    <button 
                        onclick="window.open('https://zhenti.burningvocabulary.cn/', '_blank')"
                        style="padding: 8px 12px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; display: flex; align-items: center; gap: 6px;"
                        title="åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€">
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                            <polyline points="15,3 21,3 21,9"/>
                            <line x1="10" y1="14" x2="21" y2="3"/>
                        </svg>
                        æ–°çª—å£
                    </button>
                </div>
                <iframe 
                    id="zhenti-iframe" 
                    src="https://zhenti.burningvocabulary.cn/" 
                    style="width: 100%; height: 100%; border: none; border-radius: 12px;"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            </div>
        </div>

        <!-- ã€è§†å›¾7ã€‘èµ„æºåº“ -->
        <div id="resource-view" class="view dashboard-grid">
            <div class="grid-item glass-effect" style="grid-column: 1 / -1;">
                <h3 class="card-title">ğŸ“š å­¦ä¹ èµ„æºåº“</h3>
                <p style="color: var(--text-color-darker); margin-bottom: 30px;">ç²¾é€‰ä¼˜è´¨å­¦ä¹ èµ„æºï¼ŒåŠ©åŠ›å››å…­çº§å¤‡è€ƒ</p>
            </div>

            <!-- æˆ‘æ˜¯ç‘æ€æ‹œç½‘è¯¾èµ„æº -->
            <div class="grid-item glass-effect">
                <h3 class="card-title">ğŸ“ æˆ‘æ˜¯ç‘æ€æ‹œç½‘è¯¾èµ„æº</h3>
                <p style="color: var(--text-color-darker); margin-bottom: 20px;">ä¸“ä¸šçš„å››å…­çº§ç½‘è¯¾èµ„æºï¼Œç³»ç»ŸåŒ–å­¦ä¹ æ–¹æ¡ˆ</p>
                
                <div class="resource-section">
                    <h4 style="color: var(--accent-text); margin-bottom: 15px; font-size: var(--font-size-large);">ğŸ“– å››çº§èµ„æº</h4>
                    <div class="resource-item">
                        <div class="resource-info">
                            <h5>å››çº§å…¨å¥—ç½‘è¯¾èµ„æº</h5>
                            <p>åŒ…å«å¬åŠ›ã€é˜…è¯»ã€å†™ä½œã€ç¿»è¯‘å…¨æ¨¡å—æ•™å­¦è§†é¢‘åŠé…å¥—èµ„æ–™</p>
                        </div>
                        <div class="resource-actions">
                            <a href="https://pan.baidu.com/s/1QqNWPPu7Wm7MxujZzmaGog?pwd=1111" target="_blank" class="btn btn-download">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7,10 12,15 17,10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                                ç™¾åº¦ç½‘ç›˜ä¸‹è½½
                            </a>
                        </div>
                    </div>
                </div>

                <div class="resource-section">
                    <h4 style="color: var(--accent-text); margin-bottom: 15px; font-size: var(--font-size-large);">ğŸ“š å…­çº§èµ„æº</h4>
                    <div class="resource-item">
                        <div class="resource-info">
                            <h5>å…­çº§å…¨å¥—ç½‘è¯¾èµ„æº</h5>
                            <p>åŒ…å«å¬åŠ›ã€é˜…è¯»ã€å†™ä½œã€ç¿»è¯‘å…¨æ¨¡å—æ•™å­¦è§†é¢‘åŠé…å¥—èµ„æ–™</p>
                        </div>
                        <div class="resource-actions">
                            <a href="https://pan.baidu.com/s/1INXa-HKcjfjKmSsBq8xVJA?pwd=1111" target="_blank" class="btn btn-download">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7,10 12,15 17,10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                                ç™¾åº¦ç½‘ç›˜ä¸‹è½½
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ›´å¤šèµ„æºå¡ç‰‡é¢„ç•™ä½ç½® -->
            <div class="grid-item glass-effect">
                <h3 class="card-title">ğŸ”„ æ›´å¤šèµ„æº</h3>
                <p style="color: var(--text-color-darker); text-align: center; padding: 40px 20px;">æ›´å¤šä¼˜è´¨å­¦ä¹ èµ„æºæ­£åœ¨æ•´ç†ä¸­...</p>
            </div>
        </div>
    </main>



    <!-- ======================= ã€æ–°å¢ã€‘å­¦ä¹ åé¦ˆæ¨¡æ€æ¡† ======================= -->
    <div id="feedback-modal" class="feedback-modal">
        <div class="feedback-content">
            <div class="feedback-header">
                <h2>ğŸ“ æ¯æ—¥å­¦ä¹ åé¦ˆ</h2>
                <button class="close-feedback">&times;</button>
            </div>

            <form id="feedback-form">
                <!-- ç¬¬1éƒ¨åˆ†ï¼šä»»åŠ¡å®Œæˆæƒ…å†µ -->
                <div class="feedback-section">
                    <h3 data-section="1">ä»Šæ—¥ä»»åŠ¡å®Œæˆæƒ…å†µ</h3>
                    <div id="task-completion-area" class="task-completion-list">
                        <!-- åŠ¨æ€ç”Ÿæˆä»»åŠ¡åˆ—è¡¨ -->
                    </div>
                </div>

                <!-- ç¬¬2éƒ¨åˆ†ï¼šå­¦ä¹ çŠ¶æ€è¯„ä¼° -->
                <div class="feedback-section">
                    <h3 data-section="2">ä»Šæ—¥å­¦ä¹ çŠ¶æ€è¯„ä¼°</h3>
                    <div class="slider-group">
                        <label class="slider-label">ä¸“æ³¨åº¦ (Focus):</label>
                        <div class="slider-container">
                            <span>1</span>
                            <input type="range" id="focus-slider" class="slider" min="1" max="5" value="3">
                            <span>5</span>
                            <div class="slider-value" id="focus-value">3</div>
                        </div>
                    </div>
                    <div class="slider-group">
                        <label class="slider-label">ç§¯ææ€§ (Motivation):</label>
                        <div class="slider-container">
                            <span>1</span>
                            <input type="range" id="motivation-slider" class="slider" min="1" max="5" value="3">
                            <span>5</span>
                            <div class="slider-value" id="motivation-value">3</div>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬3éƒ¨åˆ†ï¼šè¿‡ç¨‹åæ€ -->
                <div class="feedback-section">
                    <h3 data-section="3">è¿‡ç¨‹åæ€</h3>
                    <div class="textarea-group">
                        <label>ä»Šæ—¥äº®ç‚¹ (Highlight):</label>
                        <textarea id="highlight" placeholder="ä»Šå¤©å­¦ä¹ ä¸­ï¼Œå“ªä¸ªç¯èŠ‚è®©ä½ æœ€æœ‰æˆå°±æ„Ÿï¼Ÿå“ªæ€•åªæ˜¯ä¸€ä¸ªå°å°çš„è¿›æ­¥ã€‚"></textarea>
                    </div>
                    <div class="textarea-group">
                        <label>æœ€å¤§æŒ‘æˆ˜ (Challenge):</label>
                        <textarea id="challenge" placeholder="ä»Šå¤©é‡åˆ°çš„æœ€å¤§å›°éš¾æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå‡ºç°åœ¨å“ªä¸ªä»»åŠ¡ä¸­ï¼Ÿ"></textarea>
                    </div>
                    <div class="radio-group">
                        <label>åŸå› åˆ†æ (Why):</label>
                        <div class="radio-options">
                            <label class="radio-option">
                                <input type="radio" name="cause" value="vocabulary">
                                <span class="radio-custom"></span>
                                å•è¯ä¸è®¤è¯†
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="cause" value="grammar">
                                <span class="radio-custom"></span>
                                è¯­æ³•/é•¿éš¾å¥ç»“æ„ä¸æ¸…
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="cause" value="knowledge">
                                <span class="radio-custom"></span>
                                çŸ¥è¯†ç‚¹æ²¡æŒæ¡
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="cause" value="attention">
                                <span class="radio-custom"></span>
                                æ³¨æ„åŠ›ä¸é›†ä¸­/ç–²åŠ³
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="cause" value="time">
                                <span class="radio-custom"></span>
                                æ—¶é—´ç´§å¼ 
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="cause" value="other">
                                <span class="radio-custom"></span>
                                å…¶ä»–ï¼š<input type="text" id="cause-other" placeholder="è¯·æè¿°..." style="margin-left: 10px; flex: 1; background: transparent; border: none; color: var(--text-color); outline: none;">
                            </label>
                        </div>
                    </div>
                    <div class="textarea-group">
                        <label>æ˜æ—¥å¯¹ç­– (Action):</label>
                        <textarea id="action" placeholder="é’ˆå¯¹è¿™ä¸ªå›°éš¾ï¼Œæ˜å¤©ä½ å¯ä»¥åšä¸€ä¸ªä»€ä¹ˆæ ·çš„å¾®å°æ”¹è¿›ï¼Ÿ"></textarea>
                    </div>
                </div>

                <!-- ç¬¬4éƒ¨åˆ†ï¼šæƒ…ç»ªç®¡ç† -->
                <div class="feedback-section">
                    <h3 data-section="4">æƒ…ç»ªç®¡ç†</h3>
                    <div class="radio-group">
                        <label>å¯åŠ¨æ—¶åˆ»: ä»Šå¤©æ˜¯å¦æœ‰è¿‡"ä¸æƒ³å­¦"çš„å¿µå¤´ï¼Ÿä½ æ˜¯å¦‚ä½•å…‹æœå¹¶å¼€å§‹çš„ï¼Ÿ</label>
                        <div class="radio-options">
                            <label class="radio-option">
                                <input type="radio" name="startup" value="good-state">
                                <span class="radio-custom"></span>
                                æ²¡æœ‰è¿™ç§å¿µå¤´ï¼ŒçŠ¶æ€å¾ˆå¥½
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="startup" value="15min-method">
                                <span class="radio-custom"></span>
                                è¿ç”¨äº†"å…ˆå­¦15åˆ†é’Ÿ"çš„æ–¹æ³•
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="startup" value="switch-task">
                                <span class="radio-custom"></span>
                                æ¢äº†ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„å­¦ä¹ ä»»åŠ¡å…ˆå¼€å§‹
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="startup" value="rest-first">
                                <span class="radio-custom"></span>
                                ä¼‘æ¯äº†ä¸€ä¼šå„¿å†å¼€å§‹
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="startup" value="not-started">
                                <span class="radio-custom"></span>
                                æœ€ç»ˆæ²¡æœ‰å¼€å§‹ï¼Œéœ€è¦è­¦æƒ•
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="startup" value="other">
                                <span class="radio-custom"></span>
                                å…¶ä»–ï¼š<input type="text" id="startup-other" placeholder="è¯·æè¿°..." style="margin-left: 10px; flex: 1; background: transparent; border: none; color: var(--text-color); outline: none;">
                            </label>
                        </div>
                    </div>
                </div>

                <!-- æäº¤æŒ‰é’® -->
                <button type="submit" class="feedback-submit">å®Œæˆåé¦ˆ</button>
            </form>
        </div>
    </div>
    
    <!-- è½»é‡å›¾è¡¨åº“ï¼šChart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Excelå¯¼å‡ºåº“ï¼šSheetJS CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Excelå¯¼å‡ºå™¨ -->
    <script src="js/services/ExcelExporter.js"></script>
    <!-- é›†æˆæµ‹è¯• -->
    <script src="js/tests/HistoryIntegration.test.js"></script>
    <script>
        function editNickname() {
            const current = localStorage.getItem('nickname') || 'å¤‡è€ƒå°èƒ½æ‰‹';
            const name = prompt('è¯·è¾“å…¥ä½ çš„æ˜µç§°ï¼š', current);
            if (name !== null) {
                const trimmed = name.trim();
                if (trimmed.length === 0) return; // ç©ºå€¼ä¸å¤„ç†
                localStorage.setItem('nickname', trimmed);
                // åŒæ­¥æ›´æ–°ä¾§è¾¹æ æ˜µç§°
                const el = document.getElementById('nickname-display');
                if (el) el.textContent = trimmed;
                // åŒæ­¥æ›´æ–°é¡¶éƒ¨é—®å€™
                const greetEl = document.getElementById('greet-name');
                if (greetEl) greetEl.textContent = trimmed;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {

            // åˆå§‹åŒ–æ˜µç§°ï¼ˆä¾§è¾¹æ ä¸é¡¶éƒ¨é—®å€™ï¼‰
            const nicknameEl = document.getElementById('nickname-display');
            const greetNameEl = document.getElementById('greet-name');
            const savedNickname = localStorage.getItem('nickname') || 'å¤‡è€ƒå°èƒ½æ‰‹';
            if (nicknameEl) nicknameEl.textContent = savedNickname;
            if (greetNameEl) greetNameEl.textContent = savedNickname;

            // --- ç§»åŠ¨ç«¯ä¾§æ æ§åˆ¶ ---
            const hamburgerMenu = document.getElementById('hamburger-menu');
            const sidebar = document.querySelector('.sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');

            // åˆ‡æ¢ä¾§æ æ˜¾ç¤ºçŠ¶æ€
            function toggleSidebar() {
                const isOpen = sidebar.classList.contains('open');
                if (isOpen) {
                    closeSidebar();
                } else {
                    openSidebar();
                }
            }

            // æ‰“å¼€ä¾§æ 
            function openSidebar() {
                sidebar.classList.add('open');
                sidebarOverlay.classList.add('active');
                hamburgerMenu.classList.add('active');
                document.querySelector('.main-content').classList.add('sidebar-open');
                document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
            }

            // å…³é—­ä¾§æ 
            function closeSidebar() {
                sidebar.classList.remove('open');
                sidebarOverlay.classList.remove('active');
                hamburgerMenu.classList.remove('active');
                document.querySelector('.main-content').classList.remove('sidebar-open');
                document.body.style.overflow = ''; // æ¢å¤æ»šåŠ¨
            }

            // æ±‰å ¡èœå•ç‚¹å‡»äº‹ä»¶
            if (hamburgerMenu) {
                hamburgerMenu.addEventListener('click', toggleSidebar);
            }

            // é®ç½©å±‚ç‚¹å‡»å…³é—­ä¾§æ 
            if (sidebarOverlay) {
                sidebarOverlay.addEventListener('click', closeSidebar);
            }

            // ä¾§æ å¯¼èˆªç‚¹å‡»åè‡ªåŠ¨å…³é—­ï¼ˆç§»åŠ¨ç«¯ï¼‰
            const navLinks = document.querySelectorAll('.sidebar .nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 992) {
                        closeSidebar();
                    }
                });
            });

            // çª—å£å¤§å°æ”¹å˜æ—¶å¤„ç†ä¾§æ çŠ¶æ€
            window.addEventListener('resize', () => {
                if (window.innerWidth > 992) {
                    closeSidebar(); // å¤§å±å¹•æ—¶ç¡®ä¿ä¾§æ çŠ¶æ€æ­£å¸¸
                }
            });

            // --- æ¨¡å—4: è¯æ±‡æ‰“å¡è¡¨ï¼ˆåŒè½®å¤ä¹ ï¼‰---
            const checkinTbody = document.getElementById('checkin-tbody');
            const weekInfo = document.getElementById('week-info');
            const prevWeekBtn = document.getElementById('prev-week');
            const nextWeekBtn = document.getElementById('next-week');

            const statTotal = document.getElementById('stat-total');
            const statReview = document.getElementById('stat-review');
            const statLearn = document.getElementById('stat-learn');
            const statDays = document.getElementById('stat-days');

            const DAY_LABELS = ['å‘¨ä¸€','å‘¨äºŒ','å‘¨ä¸‰','å‘¨å››','å‘¨äº”','å‘¨å…­','å‘¨æ—¥'];
            const SLOT_LABELS = ['ä¸Šåˆ','æ™šä¸Š'];
            const ACTIONS = ['review','learn']; // å¤ä¹ /å­¦ä¹ 

            // æ•°æ®ç»“æ„ï¼šæŒ‰å‘¨ç´¢å¼•å­˜å‚¨ï¼ˆç›¸å¯¹ç¬¬1å‘¨ï¼‰ï¼Œæ¯å‘¨7å¤©ï¼Œæ¯å¤©2ä¸ªæ—¶æ®µï¼Œæ¯ä¸ªæ—¶æ®µ2ä¸ªåŠ¨ä½œ
            // å½¢å¦‚ï¼šdata[weekIndex][dayIndex][slotIndex][action]
            let checkinData = JSON.parse(localStorage.getItem('checkinData')) || {};
            let currentWeek = parseInt(localStorage.getItem('currentWeek')) || 1;

            function getWeekKey(week) { return `week_${week}`; }

            function ensureWeek(week) {
                const key = getWeekKey(week);
                if (!checkinData[key]) {
                    checkinData[key] = Array.from({length:7}, () => (
                        Array.from({length:2}, () => ({ review: false, learn: false }))
                    ));
                }
            }

            // è·å–å½“å‰æ—¥æœŸçš„æœˆä»½ç¬¬å‡ å‘¨
            function getWeekOfMonth(week) {
                const now = new Date();
                const currentYear = now.getFullYear();
                const currentMonth = now.getMonth();
                
                // è·å–å½“æœˆç¬¬ä¸€å¤©
                const firstDay = new Date(currentYear, currentMonth, 1);
                // è·å–å½“æœˆç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ ï¼ˆ0=å‘¨æ—¥ï¼Œ1=å‘¨ä¸€...ï¼‰
                const firstDayOfWeek = firstDay.getDay() === 0 ? 7 : firstDay.getDay(); // è½¬æ¢ä¸ºå‘¨ä¸€=1çš„æ ¼å¼
                
                // è®¡ç®—ç¬¬ä¸€å‘¨çš„åç§»
                const offset = firstDayOfWeek - 1;
                
                // è®¡ç®—ç›®æ ‡å‘¨çš„å¼€å§‹æ—¥æœŸ
                const targetDate = new Date(firstDay);
                targetDate.setDate(1 + (week - 1) * 7 - offset);
                
                const targetMonth = targetDate.getMonth() + 1; // æœˆä»½ä»0å¼€å§‹ï¼Œæ‰€ä»¥+1
                const targetYear = targetDate.getFullYear();
                
                // å¦‚æœè·¨æœˆäº†ï¼Œæ˜¾ç¤ºå¯¹åº”æœˆä»½
                if (targetMonth !== currentMonth + 1 || targetYear !== currentYear) {
                    return `${targetYear}å¹´${targetMonth}æœˆç¬¬${Math.ceil((targetDate.getDate() + offset) / 7)}å‘¨`;
                } else {
                    return `${currentMonth + 1}æœˆç¬¬${week}å‘¨`;
                }
            }

            function renderWeek(week) {
                ensureWeek(week);
                const weekKey = getWeekKey(week);
                const weekArr = checkinData[weekKey];
                checkinTbody.innerHTML = '';
                weekInfo.textContent = getWeekOfMonth(week);

                weekArr.forEach((day, dayIdx) => {
                    const tr = document.createElement('tr');
                    const dateTd = document.createElement('td');
                    dateTd.className = 'day-header';
                    dateTd.textContent = DAY_LABELS[dayIdx];
                    tr.appendChild(dateTd);

                    // ä¸Šåˆ/æ™šä¸Šä¸¤åˆ—
                    SLOT_LABELS.forEach((slotLabel, slotIdx) => {
                        const td = document.createElement('td');
                        const slotData = day[slotIdx];
                        const container = document.createElement('div');
                        container.className = 'time-slot';

                        const timeLabel = document.createElement('div');
                        timeLabel.className = 'time-label';
                        timeLabel.textContent = slotLabel;

                        const actions = document.createElement('div');
                        actions.className = 'checkin-actions';

                        // ä¸¤ä¸ªæŒ‰é’®ï¼šå¤ä¹ /å­¦ä¹ 
                        ACTIONS.forEach(action => {
                            const btn = document.createElement('button');
                            btn.className = `checkin-btn ${action} ${slotData[action] ? 'completed' : ''}`;
                            btn.textContent = (action === 'review' ? 'å¤ä¹ ' : 'å­¦ä¹ ');
                            btn.addEventListener('click', () => {
                                slotData[action] = !slotData[action];
                                saveData();
                                renderWeek(currentWeek);
                            });
                            actions.appendChild(btn);
                        });

                        // ç¼–è¾‘å†…å®¹æŒ‰é’®
                        const editBtn = document.createElement('button');
                        editBtn.className = 'checkin-btn';
                        editBtn.style.background = 'rgba(255,255,255,0.08)';
                        editBtn.style.color = 'var(--text-color)';
                        editBtn.style.border = '1px solid var(--glass-border)';
                        editBtn.textContent = 'ç¼–è¾‘å†…å®¹';
                        editBtn.addEventListener('click', () => {
                            const reviewText = slotData.reviewText || '';
                            const learnText = slotData.learnText || '';
                            const reviewInput = prompt('è¯·è¾“å…¥æœ¬æ—¶æ®µã€å¤ä¹ ã€‘å†…å®¹ï¼š', reviewText);
                            if (reviewInput !== null) {
                                slotData.reviewText = reviewInput.trim();
                            }
                            const learnInput = prompt('è¯·è¾“å…¥æœ¬æ—¶æ®µã€å­¦ä¹ ã€‘å†…å®¹ï¼š', learnText);
                            if (learnInput !== null) {
                                slotData.learnText = learnInput.trim();
                            }
                            saveData();
                        });
                        actions.appendChild(editBtn);

                        container.appendChild(timeLabel);
                        container.appendChild(actions);

                        // å±•ç¤ºå†…å®¹åŒºåŸŸ
                        const contentDiv = document.createElement('div');
                        contentDiv.style.marginTop = '8px';
                        contentDiv.style.fontSize = '12px';
                        contentDiv.style.color = 'var(--text-color-darker)';
                        const r = slotData.reviewText ? `å¤ä¹ ï¼š${slotData.reviewText}` : '';
                        const l = slotData.learnText ? `å­¦ä¹ ï¼š${slotData.learnText}` : '';
                        contentDiv.textContent = [r, l].filter(Boolean).join(' ï½œ ');
                        container.appendChild(contentDiv);

                        td.appendChild(container);
                        tr.appendChild(td);
                    });
                    checkinTbody.appendChild(tr);
                });

                updateStats();
            }

            function updateStats() {
                const weekKey = getWeekKey(currentWeek);
                const weekArr = checkinData[weekKey];
                let total = 0, review = 0, learn = 0, daysReached = 0;

                const reviewDaily = Array(7).fill(0);
                const learnDaily = Array(7).fill(0);

                weekArr.forEach((day, dIdx) => {
                    let dayCount = 0;
                    day.forEach(slot => {
                        if (slot.review) { review++; total++; dayCount++; }
                        if (slot.learn)  { learn++;  total++; dayCount++; }
                    });
                    if (dayCount >= 2) { daysReached++; }

                    // æ¯æ—¥ç»Ÿè®¡ï¼šä¸Šåˆã€æ™šä¸Šæœ€å¤šå„1æ¬¡ï¼Œå› æ­¤å¤ä¹ /å­¦ä¹ çš„æ¯æ—¥è®¡æ•°åœ¨0-2ä¹‹é—´
                    reviewDaily[dIdx] = day.filter(s => s.review).length;
                    learnDaily[dIdx]  = day.filter(s => s.learn).length;
                });

                statTotal.textContent = total;
                statReview.textContent = review;
                statLearn.textContent = learn;
                statDays.textContent = `${daysReached}/7`;

                // ç»˜åˆ¶/æ›´æ–°æŠ˜çº¿å›¾
                const ctx = document.getElementById('checkin-chart');
                if (ctx) {
                    if (!window._checkinLineChart) {
                        window._checkinLineChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: DAY_LABELS,
                                datasets: [
                                    {
                                        label: 'å¤ä¹ ',
                                        data: reviewDaily,
                                        borderColor: getComputedStyle(document.documentElement).getPropertyValue('--review-color').trim(),
                                        backgroundColor: 'rgba(255, 193, 7, 0.15)',
                                        tension: 0.35,
                                        fill: true,
                                        pointRadius: 3,
                                        pointHoverRadius: 5
                                    },
                                    {
                                        label: 'å­¦ä¹ ',
                                        data: learnDaily,
                                        borderColor: getComputedStyle(document.documentElement).getPropertyValue('--learn-color').trim(),
                                        backgroundColor: 'rgba(33, 150, 243, 0.15)',
                                        tension: 0.35,
                                        fill: true,
                                        pointRadius: 3,
                                        pointHoverRadius: 5
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { 
                                        labels: { 
                                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color').trim() || '#e0e6f1',
                                            font: { size: 20 }
                                        } 
                                    }
                                },
                                scales: {
                                    x: { 
                                        ticks: { 
                                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color-darker').trim() || '#a5afc6',
                                            font: { size: 20 }
                                        }, 
                                        grid: { color: 'rgba(255,255,255,0.06)' }
                                    },
                                    y: { 
                                        beginAtZero: true, 
                                        suggestedMax: 2, 
                                        ticks: { 
                                            stepSize: 1, 
                                            color: getComputedStyle(document.documentElement).getPropertyValue('--text-color-darker').trim() || '#a5afc6',
                                            font: { size: 20 }
                                        }, 
                                        grid: { color: 'rgba(255,255,255,0.06)' }
                                    }
                                }
                            }
                        });
                    } else {
                        window._checkinLineChart.data.datasets[0].data = reviewDaily;
                        window._checkinLineChart.data.datasets[1].data = learnDaily;
                        window._checkinLineChart.update();
                    }
                }
            }

            function saveData() {
                localStorage.setItem('checkinData', JSON.stringify(checkinData));
                localStorage.setItem('currentWeek', currentWeek);
            }

            prevWeekBtn.addEventListener('click', () => { if (currentWeek > 1) { currentWeek--; saveData(); renderWeek(currentWeek); } });
            nextWeekBtn.addEventListener('click', () => { currentWeek++; saveData(); renderWeek(currentWeek); });

            // åˆå§‹æ¸²æŸ“ï¼ˆä¿æŒå…¶ä»–æ¨¡å—ä¹‹åæ‰§è¡Œï¼‰
            renderWeek(currentWeek);


            // --- æ¨¡å—6: å†å²å›é¡¾åŠŸèƒ½ ---
            let historyDataManager = null;
            let currentHistoryPage = 1;
            const historyPageSize = 10;
            let currentDateRange = '30';
            let currentDataType = 'all';
            let historyTrendChart = null;

            // åˆå§‹åŒ–å†å²å›é¡¾åŠŸèƒ½
            async function initHistoryView() {
                try {
                    // åŠ¨æ€å¯¼å…¥å†å²æ•°æ®ç®¡ç†å™¨
                    const { HistoryDataManager } = await import('js/utils/HistoryDataManager.js');
                    historyDataManager = new HistoryDataManager();
                    
                    // åŠ è½½ç»Ÿè®¡æ•°æ®
                    await loadHistoryStats();
                    
                    // åŠ è½½è¶‹åŠ¿å›¾è¡¨
                    await loadHistoryChart();
                    
                    // åŠ è½½å†å²æ•°æ®åˆ—è¡¨
                    await loadHistoryData();
                    
                } catch (error) {
                    console.error('åˆå§‹åŒ–å†å²å›é¡¾åŠŸèƒ½å¤±è´¥:', error);
                    showHistoryError('åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                }
            }

            // åŠ è½½ç»Ÿè®¡æ•°æ®
            async function loadHistoryStats() {
                try {
                    const stats = await historyDataManager.getStatistics();
                    
                    document.getElementById('total-days').textContent = stats.overview.totalDays || 0;
                    document.getElementById('avg-completion').textContent = `${Math.round(stats.overview.avgTaskCompletion || 0)}%`;
                    document.getElementById('streak-days').textContent = stats.patterns.longestStreak || 0;
                    document.getElementById('avg-focus').textContent = Math.round(stats.overview.avgFocus || 0);
                    
                } catch (error) {
                    console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                }
            }

            // åŠ è½½è¶‹åŠ¿å›¾è¡¨
            async function loadHistoryChart() {
                try {
                    const endDate = new Date();
                    const startDate = new Date();
                    
                    if (currentDateRange === 'all') {
                        startDate.setFullYear(startDate.getFullYear() - 1); // æœ€å¤šæ˜¾ç¤º1å¹´
                    } else {
                        startDate.setDate(startDate.getDate() - parseInt(currentDateRange));
                    }
                    
                    const dateRange = await historyDataManager.getDateRangeData(
                        startDate.toISOString().split('T')[0],
                        endDate.toISOString().split('T')[0],
                        { fillGaps: true }
                    );
                    
                    renderHistoryChart(dateRange);
                    
                } catch (error) {
                    console.error('åŠ è½½è¶‹åŠ¿å›¾è¡¨å¤±è´¥:', error);
                }
            }

            // æ¸²æŸ“å†å²è¶‹åŠ¿å›¾è¡¨
            function renderHistoryChart(data) {
                const ctx = document.getElementById('history-trend-chart');
                if (!ctx) return;
                
                const labels = data.map(item => {
                    const date = new Date(item.date);
                    return `${date.getMonth() + 1}/${date.getDate()}`;
                });
                
                const taskCompletionData = data.map(item => item.taskCompletion || 0);
                const focusData = data.map(item => item.focus || 0);
                const motivationData = data.map(item => item.motivation || 0);
                
                if (historyTrendChart) {
                    historyTrendChart.destroy();
                }
                
                historyTrendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'ä»»åŠ¡å®Œæˆç‡ (%)',
                                data: taskCompletionData,
                                borderColor: getComputedStyle(document.documentElement).getPropertyValue('--accent-color').trim(),
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                tension: 0.4,
                                fill: true,
                                pointRadius: 3,
                                pointHoverRadius: 6
                            },
                            {
                                label: 'ä¸“æ³¨åº¦',
                                data: focusData,
                                borderColor: getComputedStyle(document.documentElement).getPropertyValue('--success-color').trim(),
                                backgroundColor: 'rgba(34, 197, 94, 0.1)',
                                tension: 0.4,
                                fill: false,
                                pointRadius: 3,
                                pointHoverRadius: 6
                            },
                            {
                                label: 'ç§¯ææ€§',
                                data: motivationData,
                                borderColor: getComputedStyle(document.documentElement).getPropertyValue('--warning-color').trim(),
                                backgroundColor: 'rgba(251, 191, 36, 0.1)',
                                tension: 0.4,
                                fill: false,
                                pointRadius: 3,
                                pointHoverRadius: 6
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: getComputedStyle(document.documentElement).getPropertyValue('--text-color').trim(),
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#fff',
                                bodyColor: '#fff',
                                borderColor: 'rgba(255, 255, 255, 0.2)',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: getComputedStyle(document.documentElement).getPropertyValue('--text-color-darker').trim(),
                                    font: { size: 11 }
                                },
                                grid: { color: 'rgba(255,255,255,0.06)' }
                            },
                            y: {
                                beginAtZero: true,
                                suggestedMax: 100,
                                ticks: {
                                    color: getComputedStyle(document.documentElement).getPropertyValue('--text-color-darker').trim(),
                                    font: { size: 11 }
                                },
                                grid: { color: 'rgba(255,255,255,0.06)' }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const elementIndex = elements[0].index;
                                const clickedDate = data[elementIndex]?.date;
                                if (clickedDate) {
                                    window.viewHistoryDetail(clickedDate);
                                }
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        }
                    }
                });
            }

            // åŠ è½½å†å²æ•°æ®åˆ—è¡¨
            async function loadHistoryData() {
                try {
                    const options = {
                        page: currentHistoryPage,
                        pageSize: historyPageSize,
                        sortBy: 'date',
                        sortOrder: 'desc'
                    };
                    
                    if (currentDateRange !== 'all') {
                        const endDate = new Date();
                        const startDate = new Date();
                        startDate.setDate(startDate.getDate() - parseInt(currentDateRange));
                        
                        options.startDate = startDate.toISOString().split('T')[0];
                        options.endDate = endDate.toISOString().split('T')[0];
                    }
                    
                    const result = await historyDataManager.getSnapshotList(options);
                    
                    renderHistoryTable(result.snapshots);
                    updateHistoryPagination(result.pagination);
                    
                } catch (error) {
                    console.error('åŠ è½½å†å²æ•°æ®å¤±è´¥:', error);
                    showHistoryError('åŠ è½½æ•°æ®å¤±è´¥');
                }
            }

            // æ¸²æŸ“å†å²æ•°æ®è¡¨æ ¼
            function renderHistoryTable(snapshots) {
                const tbody = document.getElementById('history-table-body');
                const emptyState = document.getElementById('empty-state');
                const table = document.getElementById('history-data-table');
                
                if (!snapshots || snapshots.length === 0) {
                    table.style.display = 'none';
                    emptyState.style.display = 'block';
                    return;
                }
                
                table.style.display = 'table';
                emptyState.style.display = 'none';
                
                tbody.innerHTML = '';
                
                snapshots.forEach(snapshot => {
                    const row = document.createElement('tr');
                    row.style.borderBottom = '1px solid var(--glass-border)';
                    row.style.transition = 'background-color 0.2s ease';
                    
                    // æ ¼å¼åŒ–æ—¥æœŸ
                    const date = new Date(snapshot.date);
                    const formattedDate = `${date.getMonth() + 1}/${date.getDate()}`;
                    
                    // ä»»åŠ¡å®Œæˆç‡
                    const taskCompletion = snapshot.taskCompletion || 0;
                    const taskCompletionColor = taskCompletion >= 80 ? 'var(--success-color)' : 
                                               taskCompletion >= 60 ? 'var(--warning-color)' : 'var(--error-color)';
                    
                    // ä¸“æ³¨åº¦å’Œç§¯ææ€§
                    const focus = snapshot.focus || 0;
                    const motivation = snapshot.motivation || 0;
                    
                    // è¯æ±‡æ‰“å¡ç»Ÿè®¡
                    const checkinStats = snapshot.checkinStats || { total: 0, review: 0, learn: 0 };
                    const checkinText = `${checkinStats.total}æ¬¡ (å¤ä¹ ${checkinStats.review}/å­¦ä¹ ${checkinStats.learn})`;
                    
                    row.innerHTML = `
                        <td style="padding: 12px; color: var(--text-color);">${formattedDate}</td>
                        <td style="padding: 12px;">
                            <span style="color: ${taskCompletionColor}; font-weight: 600;">${taskCompletion}%</span>
                        </td>
                        <td style="padding: 12px; color: var(--text-color);">${focus}/5</td>
                        <td style="padding: 12px; color: var(--text-color);">${motivation}/5</td>
                        <td style="padding: 12px; color: var(--text-color-darker); font-size: 13px;">${checkinText}</td>
                        <td style="padding: 12px;">
                            <button onclick="viewHistoryDetail('${snapshot.date}')" 
                                    style="padding: 4px 8px; border-radius: 4px; background: rgba(255,255,255,0.1); 
                                           border: 1px solid var(--glass-border); color: var(--text-color); 
                                           cursor: pointer; font-size: 12px;">è¯¦æƒ…</button>
                        </td>
                    `;
                    
                    // æ‚¬åœæ•ˆæœ
                    row.addEventListener('mouseenter', () => {
                        row.style.backgroundColor = 'rgba(255,255,255,0.05)';
                    });
                    
                    row.addEventListener('mouseleave', () => {
                        row.style.backgroundColor = 'transparent';
                    });
                    
                    tbody.appendChild(row);
                });
            }

            // æ›´æ–°åˆ†é¡µä¿¡æ¯
            function updateHistoryPagination(pagination) {
                document.getElementById('data-count').textContent = `å…± ${pagination.total} æ¡è®°å½•`;
                document.getElementById('page-info').textContent = `${pagination.currentPage}/${pagination.totalPages}`;
                
                const prevBtn = document.getElementById('prev-page');
                const nextBtn = document.getElementById('next-page');
                
                prevBtn.disabled = pagination.currentPage <= 1;
                nextBtn.disabled = pagination.currentPage >= pagination.totalPages;
                
                prevBtn.style.opacity = prevBtn.disabled ? '0.5' : '1';
                nextBtn.style.opacity = nextBtn.disabled ? '0.5' : '1';
            }

            // æŸ¥çœ‹å†å²è¯¦æƒ…
            window.viewHistoryDetail = async function(date) {
                try {
                    const snapshot = await historyDataManager.getSnapshot(date);
                    if (snapshot) {
                        showHistoryDetailModal(snapshot);
                    } else {
                        alert('æœªæ‰¾åˆ°è¯¥æ—¥æœŸçš„å­¦ä¹ è®°å½•');
                    }
                } catch (error) {
                    console.error('è·å–å†å²è¯¦æƒ…å¤±è´¥:', error);
                    alert('è·å–è¯¦æƒ…å¤±è´¥ï¼Œè¯·é‡è¯•');
                }
            };
            
            // ä¸ºå…¨å±€è®¿é—®æä¾›åˆ«å
            window.viewHistoryDetailFromChart = window.viewHistoryDetail;

            // æ˜¾ç¤ºå†å²è¯¦æƒ…æ¨¡æ€æ¡†
            function showHistoryDetailModal(snapshot) {
                // åˆ›å»ºæ¨¡æ€æ¡†HTML
                const modalHtml = `
                    <div id="history-detail-modal" class="modal" style="display: flex; z-index: 1001;">
                        <div class="modal-content" style="width: min(600px, 90vw); max-height: 80vh; overflow: auto;">
                            <div class="modal-header">
                                <h3>ğŸ“… ${snapshot.date} å­¦ä¹ è¯¦æƒ…</h3>
                                <button onclick="closeHistoryDetailModal()">&times;</button>
                            </div>
                            <div class="modal-body" style="padding: 20px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                    <div class="detail-card" style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                                        <h4 style="margin: 0 0 10px 0; color: var(--accent-color);">ğŸ“‹ ä»»åŠ¡å®Œæˆæƒ…å†µ</h4>
                                        <p style="margin: 5px 0; color: var(--text-color);">å®Œæˆç‡: <strong>${snapshot.taskCompletion || 0}%</strong></p>
                                        <p style="margin: 5px 0; color: var(--text-color-darker); font-size: 14px;">æ€»ä»»åŠ¡: ${snapshot.tasks?.length || 0} ä¸ª</p>
                                        <p style="margin: 5px 0; color: var(--text-color-darker); font-size: 14px;">å·²å®Œæˆ: ${snapshot.tasks?.filter(t => t.completed).length || 0} ä¸ª</p>
                                    </div>
                                    <div class="detail-card" style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                                        <h4 style="margin: 0 0 10px 0; color: var(--success-color);">ğŸ¯ å­¦ä¹ çŠ¶æ€</h4>
                                        <p style="margin: 5px 0; color: var(--text-color);">ä¸“æ³¨åº¦: <strong>${snapshot.focus || 0}/5</strong></p>
                                        <p style="margin: 5px 0; color: var(--text-color);">ç§¯ææ€§: <strong>${snapshot.motivation || 0}/5</strong></p>
                                    </div>
                                </div>
                                
                                ${snapshot.tasks && snapshot.tasks.length > 0 ? `
                                    <div style="margin-bottom: 20px;">
                                        <h4 style="margin: 0 0 10px 0; color: var(--text-color);">ğŸ“ ä»»åŠ¡åˆ—è¡¨</h4>
                                        <div style="max-height: 200px; overflow-y: auto;">
                                            ${snapshot.tasks.map(task => `
                                                <div style="display: flex; align-items: center; gap: 10px; padding: 8px; 
                                                           background: rgba(0,0,0,0.2); border-radius: 6px; margin-bottom: 5px;">
                                                    <span style="color: ${task.completed ? 'var(--success-color)' : 'var(--text-color-darker)'}; font-size: 16px;">
                                                        ${task.completed ? 'âœ…' : 'â­•'}
                                                    </span>
                                                    <span style="color: var(--text-color); font-size: 14px; flex: 1;">${task.text}</span>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                                
                                ${snapshot.checkinStats ? `
                                    <div>
                                        <h4 style="margin: 0 0 10px 0; color: var(--warning-color);">ğŸ“š è¯æ±‡æ‰“å¡</h4>
                                        <p style="margin: 5px 0; color: var(--text-color);">æ€»æ‰“å¡: <strong>${snapshot.checkinStats.total || 0}</strong> æ¬¡</p>
                                        <p style="margin: 5px 0; color: var(--text-color);">å¤ä¹ : <strong>${snapshot.checkinStats.review || 0}</strong> æ¬¡</p>
                                        <p style="margin: 5px 0; color: var(--text-color);">å­¦ä¹ : <strong>${snapshot.checkinStats.learn || 0}</strong> æ¬¡</p>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
                
                // æ·»åŠ åˆ°é¡µé¢
                document.body.insertAdjacentHTML('beforeend', modalHtml);
            }

            // å…³é—­å†å²è¯¦æƒ…æ¨¡æ€æ¡†
            window.closeHistoryDetailModal = function() {
                const modal = document.getElementById('history-detail-modal');
                if (modal) {
                    modal.remove();
                }
            };
            


            // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
            function showHistoryError(message) {
                const emptyState = document.getElementById('empty-state');
                if (emptyState) {
                    emptyState.style.display = 'block';
                    emptyState.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px; opacity: 0.6; color: var(--error-color);"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                        <p style="margin: 0; font-size: 16px; color: var(--error-color);">${message}</p>
                        <button onclick="location.reload()" style="margin-top: 10px; padding: 8px 16px; border-radius: 6px; background: var(--accent-color); border: none; color: white; cursor: pointer;">é‡æ–°åŠ è½½</button>
                    `;
                }
            }

            // å†å²å›é¡¾äº‹ä»¶ç›‘å¬å™¨
            document.addEventListener('DOMContentLoaded', () => {
                // æ—¥æœŸèŒƒå›´é€‰æ‹©
                const dateRangeSelect = document.getElementById('date-range-select');
                if (dateRangeSelect) {
                    dateRangeSelect.addEventListener('change', async (e) => {
                        currentDateRange = e.target.value;
                        currentHistoryPage = 1;
                        await loadHistoryChart();
                        await loadHistoryData();
                        await loadHistoryStats();
                    });
                }
                
                // æ•°æ®ç±»å‹é€‰æ‹©
                const dataTypeSelect = document.getElementById('data-type-select');
                if (dataTypeSelect) {
                    dataTypeSelect.addEventListener('change', async (e) => {
                        currentDataType = e.target.value;
                        currentHistoryPage = 1;
                        await loadHistoryData();
                    });
                }
                
                // åˆ·æ–°æŒ‰é’®
                const refreshBtn = document.getElementById('refresh-history');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', async () => {
                        refreshBtn.textContent = 'ğŸ”„ åˆ·æ–°ä¸­...';
                        refreshBtn.disabled = true;
                        
                        try {
                            await loadHistoryStats();
                            await loadHistoryChart();
                            await loadHistoryData();
                        } finally {
                            refreshBtn.textContent = 'ğŸ”„ åˆ·æ–°';
                            refreshBtn.disabled = false;
                        }
                    });
                }
                
                // å¯¼å‡ºæŒ‰é’®
                const exportBtn = document.getElementById('export-history');
                if (exportBtn) {
                    exportBtn.addEventListener('click', async () => {
                        try {
                            exportBtn.textContent = 'ğŸ“Š å¯¼å‡ºä¸­...';
                            exportBtn.disabled = true;
                            
                            // è·å–å½“å‰ç­›é€‰æ¡ä»¶
                            const startDate = document.getElementById('start-date')?.value;
                            const endDate = document.getElementById('end-date')?.value;
                            
                            // æ£€æŸ¥æ˜¯å¦æ”¯æŒExcelå¯¼å‡º
                            const supportedFormats = historyDataManager.getSupportedExportFormats();
                            const hasExcel = supportedFormats.some(f => f.value === 'excel');
                            
                            let format = 'json'; // é»˜è®¤æ ¼å¼
                            
                            // å¦‚æœæ”¯æŒExcelï¼Œè¯¢é—®ç”¨æˆ·é€‰æ‹©æ ¼å¼
                            if (hasExcel) {
                                const choice = confirm('é€‰æ‹©å¯¼å‡ºæ ¼å¼ï¼š\nç¡®å®š = Excelæ ¼å¼ï¼ˆæ¨èï¼‰\nå–æ¶ˆ = JSONæ ¼å¼');
                                format = choice ? 'excel' : 'json';
                            }
                            
                            const exportOptions = {
                                format: format,
                                startDate: startDate,
                                endDate: endDate,
                                includeSummary: format === 'excel' // Excelæ ¼å¼åŒ…å«æ‘˜è¦
                            };
                            
                            const result = await historyDataManager.exportData(exportOptions);
                            
                            if (result.success) {
                                if (format === 'excel') {
                                    // Excelå¯¼å‡ºç”±ExcelExporterç›´æ¥å¤„ç†ä¸‹è½½
                                    alert(`âœ… ${result.message}`);
                                } else {
                                    // JSON/CSVæ ¼å¼éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸‹è½½
                                    const blob = new Blob([result.data], { type: result.mimeType });
                                    const url = URL.createObjectURL(blob);
                                    const a = document.createElement('a');
                                    a.href = url;
                                    a.download = result.filename;
                                    document.body.appendChild(a);
                                    a.click();
                                    document.body.removeChild(a);
                                    URL.revokeObjectURL(url);
                                    
                                    alert(`âœ… æˆåŠŸå¯¼å‡º ${result.recordCount} æ¡è®°å½•`);
                                }
                            } else {
                                throw new Error(result.error || 'å¯¼å‡ºå¤±è´¥');
                            }
                            
                        } catch (error) {
                            console.error('å¯¼å‡ºå¤±è´¥:', error);
                            alert(`âŒ å¯¼å‡ºå¤±è´¥: ${error.message}`);
                        } finally {
                            exportBtn.textContent = 'ğŸ“Š å¯¼å‡º';
                            exportBtn.disabled = false;
                        }
                    });
                }
                
                // æµ‹è¯•æŒ‰é’®
                const testBtn = document.getElementById('test-history');
                if (testBtn) {
                    testBtn.addEventListener('click', async () => {
                        try {
                            testBtn.textContent = 'ğŸ§ª æµ‹è¯•ä¸­...';
                            testBtn.disabled = true;
                            
                            // åˆ›å»ºå¹¶è¿è¡Œé›†æˆæµ‹è¯•
                            if (typeof HistoryIntegrationTest !== 'undefined') {
                                const test = new HistoryIntegrationTest();
                                const result = await test.runAllTests();
                                
                                // æ˜¾ç¤ºæµ‹è¯•ç»“æœæ‘˜è¦
                                const message = `ğŸ§ª é›†æˆæµ‹è¯•å®Œæˆ\n\n` +
                                    `ğŸ“Š æ€»æµ‹è¯•æ•°: ${result.total}\n` +
                                    `âœ… é€šè¿‡: ${result.passed}\n` +
                                    `âŒ å¤±è´¥: ${result.failed}\n` +
                                    `ğŸ“ˆ é€šè¿‡ç‡: ${result.passRate}%\n\n` +
                                    `è¯¦ç»†ç»“æœè¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°`;
                                
                                alert(message);
                            } else {
                                alert('âŒ æµ‹è¯•æ¨¡å—æœªåŠ è½½');
                            }
                            
                        } catch (error) {
                            console.error('æµ‹è¯•æ‰§è¡Œå¤±è´¥:', error);
                            alert(`âŒ æµ‹è¯•æ‰§è¡Œå¤±è´¥: ${error.message}`);
                        } finally {
                            testBtn.textContent = 'ğŸ§ª æµ‹è¯•';
                            testBtn.disabled = false;
                        }
                    });
                }
                
                // åˆ†é¡µæŒ‰é’®
                const prevBtn = document.getElementById('prev-page');
                const nextBtn = document.getElementById('next-page');
                
                if (prevBtn) {
                    prevBtn.addEventListener('click', async () => {
                        if (currentHistoryPage > 1) {
                            currentHistoryPage--;
                            await loadHistoryData();
                        }
                    });
                }
                
                if (nextBtn) {
                    nextBtn.addEventListener('click', async () => {
                        currentHistoryPage++;
                        await loadHistoryData();
                    });
                }
            });


            // --- æ¨¡å—1: é¡µé¢/è§†å›¾åˆ‡æ¢ ---
            const viewNavLinks = document.querySelectorAll('.nav-link');
            const views = document.querySelectorAll('.view');
            
            viewNavLinks.forEach(link => {
                link.addEventListener('click', async () => {
                    // æ¿€æ´»ä¾§è¾¹æ æ ·å¼
                    viewNavLinks.forEach(nav => nav.classList.remove('active'));
                    link.classList.add('active');
                    
                    // æ˜¾ç¤ºå¯¹åº”çš„è§†å›¾
                    const targetViewId = link.getAttribute('data-view');
                    views.forEach(view => {
                        view.classList.remove('active', 'active-grid');
                        if (view.id === targetViewId) {
                            if (view.classList.contains('dashboard-grid')) {
                                view.classList.add('active-grid');
                            } else {
                                view.classList.add('active');
                            }
                        }
                    });
                    
                    // ç‰¹æ®Šå¤„ç†å†å²å›é¡¾è§†å›¾
                    if (targetViewId === 'history-view') {
                        if (!historyDataManager) {
                            await initHistoryView();
                        } else {
                            // å¦‚æœå·²ç»åˆå§‹åŒ–ï¼Œåˆ·æ–°æ•°æ®
                            await loadHistoryStats();
                            await loadHistoryChart();
                            await loadHistoryData();
                        }
                    }
                });
            });

            // --- çœŸé¢˜åœ¨çº¿æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨ ---
            const openZhentiBtn = document.getElementById('open-zhenti-external');
            if (openZhentiBtn) {
                openZhentiBtn.addEventListener('click', () => {
                    window.open('https://zhenti.burningvocabulary.cn/', '_blank');
                });
            }

            // --- å¬åŠ›è®­ç»ƒæŒ‰é’®äº‹ä»¶ç›‘å¬å™¨ ---
            const openListeningBtn = document.getElementById('open-listening-external');
            if (openListeningBtn) {
                openListeningBtn.addEventListener('click', () => {
                    window.open('https://www.21voa.com/special_english/', '_blank');
                });
            }

            // --- æ¨¡å—2: å¯ç¼–è¾‘çš„ä»Šæ—¥ä»»åŠ¡ ---
            const taskForm = document.getElementById('add-task-form');
            const taskInput = document.getElementById('new-task-input');
            const taskListUl = document.getElementById('task-list-ul');

            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½ä»»åŠ¡
            let tasks = JSON.parse(localStorage.getItem('tasks')) || [
                { text: "ä¸Šåˆè¯æ±‡å­¦ä¹ : å¤ä¹  'peri' + å­¦ä¹  'indenti' è¯æ ¹", completed: false },
                { text: "å¬åŠ›ç²¾å¬è®­ç»ƒ: VOA æ…¢é€Ÿè‹±è¯­ä¸€ç¯‡", completed: false },
                { text: "æ™šä¸Šè¯æ±‡å¤ä¹ : å·©å›ºä»Šå¤©æ‰€å­¦ (è‡³å°‘é—´éš”6h)", completed: true }
            ];

            function saveTasks() {
                localStorage.setItem('tasks', JSON.stringify(tasks));
            }

            function renderTasks() {
                taskListUl.innerHTML = '';
                tasks.forEach((task, index) => {
                    const li = document.createElement('li');
                    
                    li.innerHTML = `
                        <input type="checkbox" id="task${index}" ${task.completed ? 'checked' : ''}>
                        <label for="task${index}">
                            <span class="custom-checkbox">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                            </span>
                            <span class="task-text">${task.text}</span>
                        </label>
                        <button class="delete-task" data-index="${index}">&times;</button>
                    `;
                    
                    // æ·»åŠ å®Œæˆä»»åŠ¡çš„äº‹ä»¶ç›‘å¬
                    li.querySelector('input[type="checkbox"]').addEventListener('change', () => {
                        tasks[index].completed = !tasks[index].completed;
                        saveTasks();
                        renderTasks();
                    });

                    // æ·»åŠ åˆ é™¤ä»»åŠ¡çš„äº‹ä»¶ç›‘å¬
                    li.querySelector('.delete-task').addEventListener('click', (e) => {
                        const taskIndex = e.target.getAttribute('data-index');
                        tasks.splice(taskIndex, 1);
                        saveTasks();
                        renderTasks();
                    });

                    taskListUl.appendChild(li);
                });
            }

            taskForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const taskText = taskInput.value.trim();
                if (taskText) {
                    tasks.push({ text: taskText, completed: false });
                    saveTasks();
                    renderTasks();
                    taskInput.value = '';
                }
            });

            renderTasks(); // åˆå§‹æ¸²æŸ“





            // --- æ¨¡å—4: æ¯æ—¥å­¦ä¹ åé¦ˆ ---
            const feedbackBtn = document.getElementById('feedback-btn');
            const feedbackModal = document.getElementById('feedback-modal');
            const closeFeedbackBtn = document.querySelector('.close-feedback');
            const feedbackForm = document.getElementById('feedback-form');
            const feedbackBefore = document.getElementById('feedback-before');
            const feedbackAfter = document.getElementById('feedback-after');
            const feedbackBtnText = document.getElementById('feedback-btn-text');
            const feedbackStats = document.getElementById('feedback-stats');

            // æ»‘å—å®æ—¶æ˜¾ç¤ºå€¼
            const focusSlider = document.getElementById('focus-slider');
            const motivationSlider = document.getElementById('motivation-slider');
            const focusValue = document.getElementById('focus-value');
            const motivationValue = document.getElementById('motivation-value');

            // æ£€æŸ¥ä»Šæ—¥æ˜¯å¦å·²å®Œæˆåé¦ˆ
            function checkTodayFeedback() {
                const today = new Date().toISOString().split('T')[0];
                const feedbackData = JSON.parse(localStorage.getItem('dailyFeedbackData')) || {};
                return feedbackData[today] || null;
            }

            // åˆå§‹åŒ–åé¦ˆå¡ç‰‡çŠ¶æ€
            function initFeedbackCard() {
                const todayFeedback = checkTodayFeedback();
                if (todayFeedback) {
                    // å·²å®Œæˆåé¦ˆ - æ˜¾ç¤º"after"çŠ¶æ€
                    feedbackBefore.classList.remove('active');
                    feedbackAfter.classList.add('active');
                    feedbackBtnText.textContent = 'æŸ¥çœ‹åé¦ˆ';
                    feedbackStats.style.display = 'block';
                    
                    // æ˜¾ç¤ºä»Šæ—¥ç»Ÿè®¡
                    document.getElementById('stat-focus').textContent = todayFeedback.focus;
                    document.getElementById('stat-motivation').textContent = todayFeedback.motivation;
                    document.getElementById('stat-task-completion').textContent = todayFeedback.taskCompletion;
                } else {
                    // æœªå®Œæˆåé¦ˆ - æ˜¾ç¤º"before"çŠ¶æ€
                    feedbackBefore.classList.add('active');
                    feedbackAfter.classList.remove('active');
                    feedbackBtnText.textContent = 'å¼€å§‹åé¦ˆ';
                    feedbackStats.style.display = 'none';
                }
            }

            // è®¡ç®—ä»»åŠ¡å®Œæˆç‡
            function calculateTaskCompletion() {
                const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
                if (tasks.length === 0) return 0;
                const completedTasks = tasks.filter(task => task.completed).length;
                return Math.round((completedTasks / tasks.length) * 100);
            }

            // ç”Ÿæˆä»»åŠ¡å®Œæˆåˆ—è¡¨
            function generateTaskCompletionArea() {
                const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
                const taskArea = document.getElementById('task-completion-area');
                taskArea.innerHTML = '';
                
                tasks.forEach((task, index) => {
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-completion-item';
                    taskItem.innerHTML = `
                        <input type="checkbox" id="feedback-task-${index}" ${task.completed ? 'checked' : ''}>
                        <label for="feedback-task-${index}">
                            <span class="custom-checkbox">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                            </span>
                            <span class="task-text">${task.text}</span>
                        </label>
                    `;
                    taskArea.appendChild(taskItem);
                });
            }

            // æ»‘å—å€¼å®æ—¶æ›´æ–°
            focusSlider.addEventListener('input', () => {
                focusValue.textContent = focusSlider.value;
            });
            
            motivationSlider.addEventListener('input', () => {
                motivationValue.textContent = motivationSlider.value;
            });

            // æ‰“å¼€åé¦ˆæ¨¡æ€æ¡†
            feedbackBtn.addEventListener('click', () => {
                generateTaskCompletionArea();
                const todayFeedback = checkTodayFeedback();
                
                if (todayFeedback) {
                    // æŸ¥çœ‹æ¨¡å¼ï¼šå¡«å……å·²æœ‰æ•°æ®
                    fillFormWithData(todayFeedback);
                } else {
                    // å¡«å†™æ¨¡å¼ï¼šé‡ç½®è¡¨å•
                    feedbackForm.reset();
                    focusValue.textContent = '3';
                    motivationValue.textContent = '3';
                }
                
                feedbackModal.classList.add('open');
            });

            // å…³é—­æ¨¡æ€æ¡†
            function closeFeedbackModal() {
                feedbackModal.classList.remove('open');
            }

            closeFeedbackBtn.addEventListener('click', closeFeedbackModal);
            feedbackModal.addEventListener('click', (e) => {
                if (e.target === feedbackModal) {
                    closeFeedbackModal();
                }
            });

            // ç”¨å·²æœ‰æ•°æ®å¡«å……è¡¨å•
            function fillFormWithData(data) {
                focusSlider.value = data.focus;
                motivationSlider.value = data.motivation;
                focusValue.textContent = data.focus;
                motivationValue.textContent = data.motivation;
                
                document.getElementById('highlight').value = data.highlight || '';
                document.getElementById('challenge').value = data.challenge || '';
                document.getElementById('action').value = data.action || '';
                
                if (data.cause) {
                    const causeRadio = document.querySelector(`input[name="cause"][value="${data.cause}"]`);
                    if (causeRadio) causeRadio.checked = true;
                    if (data.cause === 'other' && data.causeOther) {
                        document.getElementById('cause-other').value = data.causeOther;
                    }
                }
                
                if (data.startup) {
                    const startupRadio = document.querySelector(`input[name="startup"][value="${data.startup}"]`);
                    if (startupRadio) startupRadio.checked = true;
                    if (data.startup === 'other' && data.startupOther) {
                        document.getElementById('startup-other').value = data.startupOther;
                    }
                }
            }

            // æäº¤åé¦ˆè¡¨å•
            feedbackForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // åŒæ­¥â€œä»»åŠ¡å®Œæˆæƒ…å†µâ€åˆ°ä»Šæ—¥ä»»åŠ¡æ•°æ®
                try {
                    const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
                    if (tasks.length > 0) {
                        tasks.forEach((task, index) => {
                            const cb = document.getElementById(`feedback-task-${index}`);
                            if (cb) task.completed = cb.checked === true;
                        });
                        localStorage.setItem('tasks', JSON.stringify(tasks));
                        // å¦‚æœæ¸²æŸ“å‡½æ•°å­˜åœ¨ï¼Œåˆ·æ–°ä»»åŠ¡åŒº
                        if (typeof renderTasks === 'function') {
                            try { renderTasks(); } catch (_) {}
                        }
                    }
                } catch (_) {}

                // é‡æ–°è®¡ç®—å®Œæˆç‡ï¼ˆåŸºäºåŒæ­¥åçš„ä»»åŠ¡çŠ¶æ€ï¼‰
                const completion = calculateTaskCompletion();
                
                // æ”¶é›†è¡¨å•æ•°æ®
                const formData = {
                    date: new Date().toISOString().split('T')[0],
                    taskCompletion: completion,
                    focus: parseInt(focusSlider.value),
                    motivation: parseInt(motivationSlider.value),
                    highlight: document.getElementById('highlight').value.trim(),
                    challenge: document.getElementById('challenge').value.trim(),
                    action: document.getElementById('action').value.trim(),
                    cause: document.querySelector('input[name="cause"]:checked')?.value || '',
                    causeOther: document.getElementById('cause-other').value.trim(),
                    startup: document.querySelector('input[name="startup"]:checked')?.value || '',
                    startupOther: document.getElementById('startup-other').value.trim(),
                    timestamp: new Date().toISOString()
                };

                // ä¿å­˜åˆ°localStorage
                const feedbackData = JSON.parse(localStorage.getItem('dailyFeedbackData')) || {};
                feedbackData[formData.date] = formData;
                localStorage.setItem('dailyFeedbackData', JSON.stringify(feedbackData));

                // å…³é—­æ¨¡æ€æ¡†å¹¶æ›´æ–°å¡ç‰‡çŠ¶æ€
                closeFeedbackModal();
                initFeedbackCard();
                updateFeedbackChart();
                
                // æ˜¾ç¤ºæˆåŠŸæç¤ºï¼ˆç®€å•çš„alertï¼Œåç»­å¯ä»¥ç”¨æ›´ä¼˜é›…çš„toastï¼‰
                alert('âœ… åé¦ˆå·²ä¿å­˜ï¼æ˜å¤©ç»§ç»­åŠ æ²¹ï½');
            });

            // æ›´æ–°åé¦ˆè¶‹åŠ¿å›¾
            function updateFeedbackChart() {
                const feedbackData = JSON.parse(localStorage.getItem('dailyFeedbackData')) || {};
                const ctx = document.getElementById('feedback-chart');
                if (!ctx) return;

                // è·å–æœ€è¿‘7å¤©çš„æ•°æ®
                const last7Days = [];
                const focusData = [];
                const motivationData = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    const dayData = feedbackData[dateStr];
                    
                    last7Days.push(date.toLocaleDateString('zh-CN', { month: 'numeric', day: 'numeric' }));
                    focusData.push(dayData ? dayData.focus : null);
                    motivationData.push(dayData ? dayData.motivation : null);
                }

                // è®¡ç®—å¹³å‡å€¼
                const validFocus = focusData.filter(val => val !== null);
                const validMotivation = motivationData.filter(val => val !== null);
                const avgFocus = validFocus.length > 0 ? (validFocus.reduce((a, b) => a + b, 0) / validFocus.length).toFixed(1) : '-';
                const avgMotivation = validMotivation.length > 0 ? (validMotivation.reduce((a, b) => a + b, 0) / validMotivation.length).toFixed(1) : '-';
                
                document.getElementById('avg-focus').textContent = avgFocus;
                document.getElementById('avg-motivation').textContent = avgMotivation;

                // åˆ›å»ºæˆ–æ›´æ–°å›¾è¡¨
                if (!window._feedbackChart) {
                    window._feedbackChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: last7Days,
                            datasets: [
                                {
                                    label: 'ä¸“æ³¨åº¦',
                                    data: focusData,
                                    borderColor: 'rgb(59, 130, 246)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    tension: 0.4,
                                    fill: true,
                                    pointRadius: 4,
                                    pointHoverRadius: 6,
                                    spanGaps: true
                                },
                                {
                                    label: 'ç§¯ææ€§',
                                    data: motivationData,
                                    borderColor: 'rgb(16, 185, 129)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    tension: 0.4,
                                    fill: true,
                                    pointRadius: 4,
                                    pointHoverRadius: 6,
                                    spanGaps: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: {
                                        color: 'rgba(224, 230, 241, 0.8)',
                                        font: { size: 12 }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: 'rgba(165, 175, 198, 0.8)',
                                        font: { size: 11 }
                                    },
                                    grid: { color: 'rgba(255,255,255,0.08)' }
                                },
                                y: {
                                    beginAtZero: true,
                                    min: 1,
                                    max: 5,
                                    ticks: {
                                        stepSize: 1,
                                        color: 'rgba(165, 175, 198, 0.8)',
                                        font: { size: 11 }
                                    },
                                    grid: { color: 'rgba(255,255,255,0.08)' }
                                }
                            }
                        }
                    });
                } else {
                    window._feedbackChart.data.labels = last7Days;
                    window._feedbackChart.data.datasets[0].data = focusData;
                    window._feedbackChart.data.datasets[1].data = motivationData;
                    window._feedbackChart.update();
                }
            }

            // åˆå§‹åŒ–åé¦ˆæ¨¡å—
            initFeedbackCard();
            updateFeedbackChart();
        });
    </script>

    <!-- é¡µé¢ç‰ˆæƒæ°´å° -->
    <div class="watermark">
        <p>Agoraå·¥ä½œç»„</p>
        <p>æœ¬ç½‘ç«™ç”±Agoraå·¥ä½œç»„ç»´æŠ¤</p>
    </div>
</body>
</html>
